var Markdown;if(typeof exports==="object"&&typeof require==="function"){Markdown=exports}else{Markdown={}}(function(){function c(e){return e}function d(e){return false}function b(){}b.prototype={chain:function(g,f){var e=this[g];if(!e){throw new Error("unknown hook "+g)}if(e===c){this[g]=f}else{this[g]=function(h){return f(e(h))}}},set:function(f,e){if(!this[f]){throw new Error("unknown hook "+f)}this[f]=e},addNoop:function(e){this[e]=c},addFalse:function(e){this[e]=d}};Markdown.HookCollection=b;function a(){}a.prototype={set:function(e,f){this["s_"+e]=f},get:function(e){return this["s_"+e]}};Markdown.Converter=function(){var k=this.hooks=new b();k.addNoop("plainLinkText");k.addNoop("preConversion");k.addNoop("postConversion");var x;var o;var e;var A;this.makeHtml=function(Q){if(x){throw new Error("Recursive call to converter.makeHtml")}x=new a();o=new a();e=[];A=0;Q=k.preConversion(Q);Q=Q.replace(/~/g,"~T");Q=Q.replace(/\$/g,"~D");Q=Q.replace(/\r\n/g,"\n");Q=Q.replace(/\r/g,"\n");Q="\n\n"+Q+"\n\n";Q=K(Q);Q=Q.replace(/^[ \t]+$/mg,"");Q=p(Q);Q=n(Q);Q=g(Q);Q=N(Q);Q=Q.replace(/~D/g,"$$");Q=Q.replace(/~T/g,"~");Q=k.postConversion(Q);e=o=x=null;return Q};function n(Q){Q=Q.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(T,V,U,S,R,W){V=V.toLowerCase();x.set(V,D(U));if(R){return S}else{if(W){o.set(V,W.replace(/"/g,"&quot;"))}}return""});return Q}function p(S){var R="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del";var Q="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math";S=S.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,P);S=S.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,P);S=S.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,P);S=S.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,P);S=S.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,P);return S}function P(Q,R){var S=R;S=S.replace(/^\n+/,"");S=S.replace(/\n+$/g,"");S="\n\n~K"+(e.push(S)-1)+"K\n\n";return S}function g(S,R){S=j(S);var Q="<hr />\n";S=S.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,Q);S=S.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,Q);S=S.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,Q);S=M(S);S=r(S);S=h(S);S=p(S);S=J(S,R);return S}function l(Q){Q=s(Q);Q=w(Q);Q=I(Q);Q=E(Q);Q=F(Q);Q=L(Q);Q=Q.replace(/~P/g,"://");Q=D(Q);Q=y(Q);Q=Q.replace(/  +\n/g," <br>\n");return Q}function w(R){var Q=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;R=R.replace(Q,function(T){var S=T.replace(/(.)<\/?code>(?=.)/g,"$1`");S=z(S,T.charAt(1)=="!"?"\\`*_/":"\\`*_");return S});return R}function F(Q){Q=Q.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,i);Q=Q.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()\s])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,i);Q=Q.replace(/(\[([^\[\]]+)\])()()()()()/g,i);return Q}function i(W,ac,ab,aa,Z,Y,V,U){if(U==undefined){U=""}var T=ac;var R=ab.replace(/:\/\//g,"~P");var S=aa.toLowerCase();var Q=Z;var X=U;if(Q==""){if(S==""){S=R.toLowerCase().replace(/ ?\n/g," ")}Q="#"+S;if(x.get(S)!=undefined){Q=x.get(S);if(o.get(S)!=undefined){X=o.get(S)}}else{if(T.search(/\(\s*\)$/m)>-1){Q=""}else{return T}}}Q=B(Q);Q=z(Q,"*_");var ad='<a href="'+Q+'"';if(X!=""){X=H(X);X=z(X,"*_");ad+=' title="'+X+'"'}ad+=">"+R+"</a>";return ad}function E(Q){Q=Q.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,G);Q=Q.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,G);return Q}function H(Q){return Q.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function G(W,ac,ab,aa,Z,Y,V,U){var T=ac;var S=ab;var R=aa.toLowerCase();var Q=Z;var X=U;if(!X){X=""}if(Q==""){if(R==""){R=S.toLowerCase().replace(/ ?\n/g," ")}Q="#"+R;if(x.get(R)!=undefined){Q=x.get(R);if(o.get(R)!=undefined){X=o.get(R)}}else{return T}}S=z(H(S),"*_[]()");Q=z(Q,"*_");var ad='<img src="'+Q+'" alt="'+S+'"';X=H(X);X=z(X,"*_");ad+=' title="'+X+'"';ad+=" />";return ad}function j(Q){Q=Q.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(R,S){return"<h1>"+l(S)+"</h1>\n\n"});Q=Q.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(S,R){return"<h2>"+l(R)+"</h2>\n\n"});Q=Q.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(R,U,T){var S=U.length;return"<h"+S+">"+l(T)+"</h"+S+">\n\n"});return Q}function M(R){R+="~0";var Q=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;if(A){R=R.replace(Q,function(T,W,V){var X=W;var U=(V.search(/[*+-]/g)>-1)?"ul":"ol";var S=m(X,U);S=S.replace(/\s+$/,"");S="<"+U+">"+S+"</"+U+">\n";return S})}else{Q=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g;R=R.replace(Q,function(U,Y,W,T){var X=Y;var Z=W;var V=(T.search(/[*+-]/g)>-1)?"ul":"ol";var S=m(Z,V);S=X+"<"+V+">\n"+S+"</"+V+">\n";return S})}R=R.replace(/~0/,"");return R}var q={ol:"\\d+[.]",ul:"[*+-]"};function m(S,R){A++;S=S.replace(/\n{2,}$/,"\n");S+="~0";var Q=q[R];var T=new RegExp("(^[ \\t]*)("+Q+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+Q+")[ \\t]+))","gm");var U=false;S=S.replace(T,function(W,Y,X,V){var ab=V;var ac=Y;var aa=/\n\n$/.test(ab);var Z=aa||ab.search(/\n{2,}/)>-1;if(Z||U){ab=g(u(ab),true)}else{ab=M(u(ab));ab=ab.replace(/\n$/,"");ab=l(ab)}U=aa;return"<li>"+ab+"</li>\n"});S=S.replace(/~0/g,"");A--;return S}function r(Q){Q+="~0";Q=Q.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(R,T,S){var U=T;var V=S;U=C(u(U));U=K(U);U=U.replace(/^\n+/g,"");U=U.replace(/\n+$/g,"");U="<pre class='prettyprint'>"+U+"\n</pre>";return"\n\n"+U+"\n\n"+V});Q=Q.replace(/~0/,"");return Q}function O(Q){Q=Q.replace(/(^\n+|\n+$)/g,"");return"\n\n~K"+(e.push(Q)-1)+"K\n\n"}function s(Q){Q=Q.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(T,V,U,S,R){var W=S;W=W.replace(/^([ \t]*)/g,"");W=W.replace(/[ \t]*$/g,"");W=C(W);W=W.replace(/:\/\//g,"~P");return V+"<code>"+W+"</code>"});return Q}function C(Q){Q=Q.replace(/&/g,"&amp;");Q=Q.replace(/</g,"&lt;");Q=Q.replace(/>/g,"&gt;");Q=z(Q,"*_{}[]\\",false);return Q}function y(Q){Q=Q.replace(/([\W_]|^)(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\2([\W_]|$)/g,"$1<strong>$3</strong>$4");Q=Q.replace(/([\W_]|^)(\*|_)(?=\S)([^\r\*_]*?\S)\2([\W_]|$)/g,"$1<em>$3</em>$4");return Q}function h(Q){Q=Q.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(R,S){var T=S;T=T.replace(/^[ \t]*>[ \t]?/gm,"~0");T=T.replace(/~0/g,"");T=T.replace(/^[ \t]+$/gm,"");T=g(T);T=T.replace(/(^|\n)/g,"$1  ");T=T.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(U,V){var W=V;W=W.replace(/^  /mg,"~0");W=W.replace(/~0/g,"");return W});return O("<blockquote>\n"+T+"\n</blockquote>")});return Q}function J(X,Q){X=X.replace(/^\n+/g,"");X=X.replace(/\n+$/g,"");var Y=X.split(/\n{2,}/g);var V=[];var R=/~K(\d+)K/;var S=Y.length;for(var T=0;T<S;T++){var U=Y[T];if(R.test(U)){V.push(U)}else{if(/\S/.test(U)){U=l(U);U=U.replace(/^([ \t]*)/g,"<p>");U+="</p>";V.push(U)}}}if(!Q){S=V.length;for(var T=0;T<S;T++){var W=true;while(W){W=false;V[T]=V[T].replace(/~K(\d+)K/g,function(Z,aa){W=true;return e[aa]})}}}return V.join("\n\n")}function D(Q){Q=Q.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");Q=Q.replace(/<(?![a-z\/?!]|~D)/gi,"&lt;");return Q}function I(Q){Q=Q.replace(/\\(\\)/g,t);Q=Q.replace(/\\([`*_{}\[\]()>#+-.!])/g,t);return Q}function f(U,W,Y,T){if(W){return U}if(T.charAt(T.length-1)!==")"){return"<"+Y+T+">"}var V=T.match(/[()]/g);var Q=0;for(var R=0;R<V.length;R++){if(V[R]==="("){if(Q<=0){Q=1}else{Q++}}else{Q--}}var S="";if(Q<0){var X=new RegExp("\\){1,"+(-Q)+"}$");T=T.replace(X,function(Z){S=Z;return""})}return"<"+Y+T+">"+S}function L(R){R=R.replace(/(="|<)?\b(https?|ftp)(:\/\/[-A-Z0-9+&@#\/%?=~_|\[\]\(\)!:,\.;]*[-A-Z0-9+&@#\/%=~_|\[\])])(?=$|\W)/gi,f);var Q=function(T,S){return'<a href="'+S+'">'+k.plainLinkText(S)+"</a>"};R=R.replace(/<((https?|ftp):[^'">\s]+)>/gi,Q);return R}function N(Q){Q=Q.replace(/~E(\d+)E/g,function(R,T){var S=parseInt(T);return String.fromCharCode(S)});return Q}function u(Q){Q=Q.replace(/^(\t|[ ]{1,4})/gm,"~0");Q=Q.replace(/~0/g,"");return Q}function K(T){if(!/\t/.test(T)){return T}var S=["    ","   ","  "," "],R=0,Q;return T.replace(/[\n\t]/g,function(U,V){if(U==="\n"){R=V+1;return U}Q=(V-R)%4;R=V+1;return S[Q]})}var v=/(?:["'*()[\]:]|~D)/g;function B(R){if(!R){return""}var Q=R.length;return R.replace(v,function(S,T){if(S=="~D"){return"%24"}if(S==":"){if(T==Q-1||/[0-9\/]/.test(R.charAt(T+1))){return":"}}return"%"+S.charCodeAt(0).toString(16)})}function z(U,R,S){var Q="(["+R.replace(/([\[\]\\])/g,"\\$1")+"])";if(S){Q="\\\\"+Q}var T=new RegExp(Q,"g");U=U.replace(T,t);return U}function t(Q,S){var R=S.charCodeAt(0);return"~E"+R+"E"}}})();(function(){var a,d;if(typeof exports==="object"&&typeof require==="function"){a=exports;d=require("./Markdown.Converter").Converter}else{a=window.Markdown;d=a.Converter}a.getSanitizingConverter=function(){var i=new d();i.hooks.chain("postConversion",c);i.hooks.chain("postConversion",b);return i};function c(i){return i.replace(/<[^>]*>?/gi,e)}var f=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i;var g=/^(<a\shref="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i;var h=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i;function e(i){if(i.match(f)||i.match(g)||i.match(h)){return i}else{return""}}function b(m){if(m==""){return""}var s=/<\/?\w+[^>]*(\s|$|>)/g;var t=m.toLowerCase().match(s);var r=(t||[]).length;if(r==0){return m}var q,u;var p="<p><img><br><li><hr>";var n;var o=[];var j=[];var l=false;for(var i=0;i<r;i++){q=t[i].replace(/<\/?(\w+).*/,"$1");if(o[i]||p.search("<"+q+">")>-1){continue}u=t[i];n=-1;if(!/^<\//.test(u)){for(var k=i+1;k<r;k++){if(!o[k]&&t[k]=="</"+q+">"){n=k;break}}}if(n==-1){l=j[i]=true}else{o[n]=true}}if(!l){return m}var i=0;m=m.replace(s,function(v){var w=j[i]?"":v;i++;return w});return m}})();(function(){var a={},r={},l={},t=window.document,m=window.RegExp,g=window.navigator,o={lineLength:72},s={isIE:/msie/.test(g.userAgent.toLowerCase()),isIE_5or6:/msie 6/.test(g.userAgent.toLowerCase())||/msie 5/.test(g.userAgent.toLowerCase()),isOpera:/opera/.test(g.userAgent.toLowerCase())};var i={bold:"Strong <strong> Ctrl+B",boldexample:"strong text",italic:"Emphasis <em> Ctrl+I",italicexample:"emphasized text",link:"Hyperlink <a> Ctrl+L",linkdescription:"enter link description here",linkdialog:'<p><b>Insert Hyperlink</b></p><p>http://example.com/ "optional title"</p>',quote:"Blockquote <blockquote> Ctrl+Q",quoteexample:"Blockquote",code:"Code Sample <pre><code> Ctrl+K",codeexample:"enter code here",image:"Image <img> Ctrl+G",imagedescription:"enter image description here",imagedialog:"<p><b>Insert Image</b></p><p>http://example.com/images/diagram.jpg \"optional title\"<br><br>Need <a href='http://www.google.com/search?q=free+image+hosting' target='_blank'>free image hosting?</a></p>",olist:"Numbered List <ol> Ctrl+O",ulist:"Bulleted List <ul> Ctrl+U",litem:"List item",heading:"Heading <h1>/<h2> Ctrl+H",headingexample:"Heading",hr:"Horizontal Rule <hr> Ctrl+R",undo:"Undo - Ctrl+Z",redo:"Redo - Ctrl+Y",redomac:"Redo - Ctrl+Shift+Z",help:"Markdown Editing Help"};var c="http://";var d="http://";Markdown.Editor=function(y,A,x){x=x||{};if(typeof x.handler==="function"){x={helpButton:x}}x.strings=x.strings||{};if(x.helpButton){x.strings.help=x.strings.help||x.helpButton.title}var v=function(B){return x.strings[B]||i[B]};A=A||"";var u=this.hooks=new Markdown.HookCollection();u.addNoop("onPreviewRefresh");u.addNoop("postBlockquoteCreation");u.addFalse("insertImageDialog");this.getConverter=function(){return y};var z=this,w;this.run=function(){if(w){return}w=new j(A);var D=new k(u,v);var B=new h(y,w,function(){u.onPreviewRefresh()});var E,C;if(!/\?noundo/.test(t.location.href)){E=new e(function(){B.refresh();if(C){C.setUndoRedoButtonStates()}},w);this.textOperation=function(G){E.setCommandMode();G();z.refreshPreview()}}C=new q(A,w,E,B,D,x.helpButton,v);C.setUndoRedoButtonStates();var F=z.refreshPreview=function(){B.refresh(true)};F()}};function p(){}p.prototype.findTags=function(v,x){var u=this;var w;if(v){w=a.extendRegExp(v,"","$");this.before=this.before.replace(w,function(y){u.startTag=u.startTag+y;return""});w=a.extendRegExp(v,"^","");this.selection=this.selection.replace(w,function(y){u.startTag=u.startTag+y;return""})}if(x){w=a.extendRegExp(x,"","$");this.selection=this.selection.replace(w,function(y){u.endTag=y+u.endTag;return""});w=a.extendRegExp(x,"^","");this.after=this.after.replace(w,function(y){u.endTag=y+u.endTag;return""})}};p.prototype.trimWhitespace=function(v){var u,x,w=this;if(v){u=x=""}else{u=function(y){w.before+=y;return""};x=function(y){w.after=y+w.after;return""}}this.selection=this.selection.replace(/^(\s*)/,u).replace(/(\s*)$/,x)};p.prototype.skipLines=function(w,v,u){if(w===undefined){w=1}if(v===undefined){v=1}w++;v++;var x;var y;if(navigator.userAgent.match(/Chrome/)){"X".match(/()./)}this.selection=this.selection.replace(/(^\n*)/,"");this.startTag=this.startTag+m.$1;this.selection=this.selection.replace(/(\n*$)/,"");this.endTag=this.endTag+m.$1;this.startTag=this.startTag.replace(/(^\n*)/,"");this.before=this.before+m.$1;this.endTag=this.endTag.replace(/(\n*$)/,"");this.after=this.after+m.$1;if(this.before){x=y="";while(w--){x+="\\n?";y+="\n"}if(u){x="\\n*"}this.before=this.before.replace(new m(x+"$",""),y)}if(this.after){x=y="";while(v--){x+="\\n?";y+="\n"}if(u){x="\\n*"}this.after=this.after.replace(new m(x,""),y)}};function j(u){this.buttonBar=t.getElementById("wmd-button-bar"+u);this.preview=t.getElementById("wmd-preview"+u);this.input=t.getElementById("wmd-input"+u)}a.isVisible=function(u){if(window.getComputedStyle){return window.getComputedStyle(u,null).getPropertyValue("display")!=="none"}else{if(u.currentStyle){return u.currentStyle["display"]!=="none"}}};a.addEvent=function(v,u,w){if(v.attachEvent){v.attachEvent("on"+u,w)}else{v.addEventListener(u,w,false)}};a.removeEvent=function(v,u,w){if(v.detachEvent){v.detachEvent("on"+u,w)}else{v.removeEventListener(u,w,false)}};a.fixEolChars=function(u){u=u.replace(/\r\n/g,"\n");u=u.replace(/\r/g,"\n");return u};a.extendRegExp=function(w,y,v){if(y===null||y===undefined){y=""}if(v===null||v===undefined){v=""}var x=w.toString();var u;x=x.replace(/\/([gim]*)$/,function(z,A){u=A;return""});x=x.replace(/(^\/|\/$)/g,"");x=y+x+v;return new m(x,u)};r.getTop=function(w,v){var u=w.offsetTop;if(!v){while(w=w.offsetParent){u+=w.offsetTop}}return u};r.getHeight=function(u){return u.offsetHeight||u.scrollHeight};r.getWidth=function(u){return u.offsetWidth||u.scrollWidth};r.getPageSize=function(){var v,w;var u,z;if(self.innerHeight&&self.scrollMaxY){v=t.body.scrollWidth;w=self.innerHeight+self.scrollMaxY}else{if(t.body.scrollHeight>t.body.offsetHeight){v=t.body.scrollWidth;w=t.body.scrollHeight}else{v=t.body.offsetWidth;w=t.body.offsetHeight}}if(self.innerHeight){u=self.innerWidth;z=self.innerHeight}else{if(t.documentElement&&t.documentElement.clientHeight){u=t.documentElement.clientWidth;z=t.documentElement.clientHeight}else{if(t.body){u=t.body.clientWidth;z=t.body.clientHeight}}}var y=Math.max(v,u);var x=Math.max(w,z);return[y,x,u,z]};function e(G,D){var J=this;var E=[];var B=0;var A="none";var v;var w;var z;var u=function(L,K){if(A!=L){A=L;if(!K){x()}}if(!s.isIE||A!="moving"){w=setTimeout(C,1)}else{z=null}};var C=function(K){z=new b(D,K);w=undefined};this.setCommandMode=function(){A="command";x();w=setTimeout(C,0)};this.canUndo=function(){return B>1};this.canRedo=function(){if(E[B+1]){return true}return false};this.undo=function(){if(J.canUndo()){if(v){v.restore();v=null}else{E[B]=new b(D);E[--B].restore();if(G){G()}}}A="none";D.input.focus();C()};this.redo=function(){if(J.canRedo()){E[++B].restore();if(G){G()}}A="none";D.input.focus();C()};var x=function(){var K=z||new b(D);if(!K){return false}if(A=="moving"){if(!v){v=K}return}if(v){if(E[B-1].text!=v.text){E[B++]=v}v=null}E[B++]=K;E[B+1]=null;if(G){G()}};var F=function(K){var M=false;if((K.ctrlKey||K.metaKey)&&!K.altKey){var L=K.charCode||K.keyCode;var N=String.fromCharCode(L);switch(N.toLowerCase()){case"y":J.redo();M=true;break;case"z":if(!K.shiftKey){J.undo()}else{J.redo()}M=true;break}}if(M){if(K.preventDefault){K.preventDefault()}if(window.event){window.event.returnValue=false}return}};var I=function(K){if(!K.ctrlKey&&!K.metaKey){var L=K.keyCode;if((L>=33&&L<=40)||(L>=63232&&L<=63235)){u("moving")}else{if(L==8||L==46||L==127){u("deleting")}else{if(L==13){u("newlines")}else{if(L==27){u("escape")}else{if((L<16||L>20)&&L!=91){u("typing")}}}}}}};var y=function(){a.addEvent(D.input,"keypress",function(L){if((L.ctrlKey||L.metaKey)&&!L.altKey&&(L.keyCode==89||L.keyCode==90)){L.preventDefault()}});var K=function(){if(s.isIE||(z&&z.text!=D.input.value)){if(w==undefined){A="paste";x();C()}}};a.addEvent(D.input,"keydown",F);a.addEvent(D.input,"keydown",I);a.addEvent(D.input,"mousedown",function(){u("moving")});D.input.onpaste=K;D.input.ondrop=K};var H=function(){y();C(true);x()};H()}function b(v,x){var u=this;var w=v.input;this.init=function(){if(!a.isVisible(w)){return}if(!x&&t.activeElement&&t.activeElement!==w){return}this.setInputAreaSelectionStartEnd();this.scrollTop=w.scrollTop;if(!this.text&&w.selectionStart||w.selectionStart===0){this.text=w.value}};this.setInputAreaSelection=function(){if(!a.isVisible(w)){return}if(w.selectionStart!==undefined&&!s.isOpera){w.focus();w.selectionStart=u.start;w.selectionEnd=u.end;w.scrollTop=u.scrollTop}else{if(t.selection){if(t.activeElement&&t.activeElement!==w){return}w.focus();var y=w.createTextRange();y.moveStart("character",-w.value.length);y.moveEnd("character",-w.value.length);y.moveEnd("character",u.end);y.moveStart("character",u.start);y.select()}}};this.setInputAreaSelectionStartEnd=function(){if(!v.ieCachedRange&&(w.selectionStart||w.selectionStart===0)){u.start=w.selectionStart;u.end=w.selectionEnd}else{if(t.selection){u.text=a.fixEolChars(w.value);var B=v.ieCachedRange||t.selection.createRange();var C=a.fixEolChars(B.text);var A="\x07";var z=A+C+A;B.text=z;var D=a.fixEolChars(w.value);B.moveStart("character",-z.length);B.text=C;u.start=D.indexOf(A);u.end=D.lastIndexOf(A)-A.length;var y=u.text.length-a.fixEolChars(w.value).length;if(y){B.moveStart("character",-C.length);while(y--){C+="\n";u.end+=1}B.text=C}if(v.ieCachedRange){u.scrollTop=v.ieCachedScrollTop}v.ieCachedRange=null;this.setInputAreaSelection()}}};this.restore=function(){if(u.text!=undefined&&u.text!=w.value){w.value=u.text}this.setInputAreaSelection();w.scrollTop=u.scrollTop};this.getChunks=function(){var y=new p();y.before=a.fixEolChars(u.text.substring(0,u.start));y.startTag="";y.selection=a.fixEolChars(u.text.substring(u.start,u.end));y.endTag="";y.after=a.fixEolChars(u.text.substring(u.end));y.scrollTop=u.scrollTop;return y};this.setChunks=function(y){y.before=y.before+y.startTag;y.after=y.endTag+y.after;this.start=y.before.length;this.end=y.before.length+y.selection.length;this.text=y.before+y.selection+y.after;this.scrollTop=y.scrollTop};this.init()}function h(O,x,I){var v=this;var C;var B;var L;var w=3000;var D="delayed";var z=function(Q,R){a.addEvent(Q,"input",R);Q.onpaste=R;Q.ondrop=R;a.addEvent(Q,"keypress",R);a.addEvent(Q,"keydown",R)};var H=function(){var Q=0;if(window.innerHeight){Q=window.pageYOffset}else{if(t.documentElement&&t.documentElement.scrollTop){Q=t.documentElement.scrollTop}else{if(t.body){Q=t.body.scrollTop}}}return Q};var A=function(){if(!x.preview){return}var S=x.input.value;if(S&&S==L){return}else{L=S}var R=new Date().getTime();S=O.makeHtml(S);var Q=new Date().getTime();B=Q-R;u(S)};var N=function(){if(C){clearTimeout(C);C=undefined}if(D!=="manual"){var Q=0;if(D==="delayed"){Q=B}if(Q>w){Q=w}C=setTimeout(A,Q)}};var y=function(Q){if(Q.scrollHeight<=Q.clientHeight){return 1}return Q.scrollTop/(Q.scrollHeight-Q.clientHeight)};var P=function(){if(x.preview){x.preview.scrollTop=(x.preview.scrollHeight-x.preview.clientHeight)*y(x.preview)}};this.refresh=function(Q){if(Q){L="";A()}else{N()}};this.processingTime=function(){return B};var E=true;var F=function(T){var S=x.preview;var R=S.parentNode;var Q=S.nextSibling;R.removeChild(S);S.innerHTML=T;if(!Q){R.appendChild(S)}else{R.insertBefore(S,Q)}};var K=function(Q){x.preview.innerHTML=Q};var G;var J=function(R){if(G){return G(R)}try{K(R);G=K}catch(Q){G=F;G(R)}};var u=function(S){var Q=r.getTop(x.input)-H();if(x.preview){J(S);I()}P();if(E){E=false;return}var R=r.getTop(x.input)-H();if(s.isIE){setTimeout(function(){window.scrollBy(0,R-Q)},0)}else{window.scrollBy(0,R-Q)}};var M=function(){z(x.input,N);A();if(x.preview){x.preview.scrollTop=0}};M()}l.createBackground=function(){var v=t.createElement("div"),w=v.style;v.className="wmd-prompt-background";w.position="absolute";w.top="0";w.zIndex="1000";if(s.isIE){w.filter="alpha(opacity=50)"}else{w.opacity="0.5"}var u=r.getPageSize();w.height=u[1]+"px";if(s.isIE){w.left=t.documentElement.scrollLeft;w.width=t.documentElement.clientWidth}else{w.left="0";w.width="100%"}t.body.appendChild(v);return v};l.prompt=function(z,x,B){var w;var v;if(x===undefined){x=""}var A=function(C){var D=(C.charCode||C.keyCode);if(D===27){y(true)}};var y=function(C){a.removeEvent(t.body,"keydown",A);var D=v.value;if(C){D=null}else{D=D.replace(/^http:\/\/(https?|ftp):\/\//,"$1://");if(!/^(?:https?|ftp):\/\//.test(D)){D="http://"+D}}w.parentNode.removeChild(w);B(D);return false};var u=function(){w=t.createElement("div");w.className="wmd-prompt-dialog";w.style.padding="10px;";w.style.position="fixed";w.style.width="400px";w.style.zIndex="1001";var C=t.createElement("div");C.innerHTML=z;C.style.padding="5px";w.appendChild(C);var E=t.createElement("form"),D=E.style;E.onsubmit=function(){return y(false)};D.padding="0";D.margin="0";D.cssFloat="left";D.width="100%";D.textAlign="center";D.position="relative";w.appendChild(E);v=t.createElement("input");v.type="text";v.value=x;D=v.style;D.display="block";D.width="80%";D.marginLeft=D.marginRight="auto";E.appendChild(v);var G=t.createElement("input");G.type="button";G.onclick=function(){return y(false)};G.value="OK";D=G.style;D.margin="10px";D.display="inline";D.width="7em";var F=t.createElement("input");F.type="button";F.onclick=function(){return y(true)};F.value="Cancel";D=F.style;D.margin="10px";D.display="inline";D.width="7em";E.appendChild(G);E.appendChild(F);a.addEvent(t.body,"keydown",A);w.style.top="50%";w.style.left="50%";w.style.display="block";if(s.isIE_5or6){w.style.position="absolute";w.style.top=t.documentElement.scrollTop+200+"px";w.style.left="50%"}t.body.appendChild(w);w.style.marginTop=-(r.getHeight(w)/2)+"px";w.style.marginLeft=-(r.getWidth(w)/2)+"px"};setTimeout(function(){u();var D=x.length;if(v.selectionStart!==undefined){v.selectionStart=0;v.selectionEnd=D}else{if(v.createTextRange){var C=v.createTextRange();C.collapse(false);C.moveStart("character",-D);C.moveEnd("character",D);C.select()}}v.focus()},0)};function q(G,B,I,x,F,A,v){var z=B.input,D={};y();var C="keydown";if(s.isOpera){C="keypress"}a.addEvent(z,C,function(K){if((K.ctrlKey||K.metaKey)&&!K.altKey&&!K.shiftKey){var L=K.charCode||K.keyCode;var J=String.fromCharCode(L).toLowerCase();switch(J){case"b":H(D.bold);break;case"i":H(D.italic);break;case"l":H(D.link);break;case"q":H(D.quote);break;case"k":H(D.code);break;case"g":H(D.image);break;case"o":H(D.olist);break;case"u":H(D.ulist);break;case"h":H(D.heading);break;case"r":H(D.hr);break;case"y":H(D.redo);break;case"z":if(K.shiftKey){H(D.redo)}else{H(D.undo)}break;default:return}if(K.preventDefault){K.preventDefault()}if(window.event){window.event.returnValue=false}}});a.addEvent(z,"keyup",function(K){if(K.shiftKey&&!K.ctrlKey&&!K.metaKey){var L=K.charCode||K.keyCode;if(L===13){var J={};J.textOp=w("doAutoindent");H(J)}}});if(s.isIE){a.addEvent(z,"keydown",function(J){var K=J.keyCode;if(K===27){return false}})}function H(K){z.focus();if(K.textOp){if(I){I.setCommandMode()}var M=new b(B);if(!M){return}var N=M.getChunks();var J=function(){z.focus();if(N){M.setChunks(N)}M.restore();x.refresh()};var L=K.textOp(N,J);if(!L){J()}}if(K.execute){K.execute(I)}}function u(J,L){var M="0px";var O="-20px";var K="-40px";var N=J.getElementsByTagName("span")[0];if(L){N.style.backgroundPosition=J.XShift+" "+M;J.onmouseover=function(){N.style.backgroundPosition=this.XShift+" "+K};J.onmouseout=function(){N.style.backgroundPosition=this.XShift+" "+M};if(s.isIE){J.onmousedown=function(){if(t.activeElement&&t.activeElement!==B.input){return}B.ieCachedRange=document.selection.createRange();B.ieCachedScrollTop=B.input.scrollTop}}if(!J.isHelp){J.onclick=function(){if(this.onmouseout){this.onmouseout()}H(this);return false}}}else{N.style.backgroundPosition=J.XShift+" "+O;J.onmouseover=J.onmouseout=J.onclick=function(){}}}function w(J){if(typeof J==="string"){J=F[J]}return function(){J.apply(F,arguments)}}function y(){var N=B.buttonBar;var R="0px";var M="-20px";var P="-40px";var Q=document.createElement("ul");Q.id="wmd-button-row"+G;Q.className="wmd-button-row";Q=N.appendChild(Q);var J=0;var S=function(Z,X,W,Y){var V=document.createElement("li");V.className="wmd-button";V.style.left=J+"px";J+=25;var U=document.createElement("span");V.id=Z+G;V.appendChild(U);V.title=X;V.XShift=W;if(Y){V.textOp=Y}u(V,true);Q.appendChild(V);return V};var L=function(V){var U=document.createElement("li");U.className="wmd-spacer wmd-spacer"+V;U.id="wmd-spacer"+V+G;Q.appendChild(U);J+=25};D.bold=S("wmd-bold-button",v("bold"),"0px",w("doBold"));D.italic=S("wmd-italic-button",v("italic"),"-20px",w("doItalic"));L(1);D.link=S("wmd-link-button",v("link"),"-40px",w(function(U,V){return this.doLinkOrImage(U,V,false)}));D.quote=S("wmd-quote-button",v("quote"),"-60px",w("doBlockquote"));D.code=S("wmd-code-button",v("code"),"-80px",w("doCode"));D.image=S("wmd-image-button",v("image"),"-100px",w(function(U,V){return this.doImage(U,V)}));L(2);D.olist=S("wmd-olist-button",v("olist"),"-120px",w(function(U,V){this.doList(U,V,true)}));D.ulist=S("wmd-ulist-button",v("ulist"),"-140px",w(function(U,V){this.doList(U,V,false)}));D.heading=S("wmd-heading-button",v("heading"),"-160px",w("doHeading"));D.hr=S("wmd-hr-button",v("hr"),"-180px",w("doHorizontalRule"));L(3);D.undo=S("wmd-undo-button",v("undo"),"-200px",null);D.undo.execute=function(U){if(U){U.undo()}};var T=/win/.test(g.platform.toLowerCase())?v("redo"):v("redomac");D.redo=S("wmd-redo-button",T,"-220px",null);D.redo.execute=function(U){if(U){U.redo()}};if(A){var O=document.createElement("li");var K=document.createElement("span");O.appendChild(K);O.className="wmd-button wmd-help-button";O.id="wmd-help-button"+G;O.XShift="-240px";O.isHelp=true;O.style.right="0px";O.title=v("help");O.onclick=A.handler;u(O,true);Q.appendChild(O);D.help=O}E()}function E(){if(I){u(D.undo,I.canUndo());u(D.redo,I.canRedo())}}this.setUndoRedoButtonStates=E}function k(v,u){this.hooks=v;this.getString=u}var f=k.prototype;f.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)";f.unwrap=function(v){var u=new m("([^\\n])\\n(?!(\\n|"+this.prefixes+"))","g");v.selection=v.selection.replace(u,"$1 $2")};f.wrap=function(v,u){this.unwrap(v);var x=new m("(.{1,"+u+"})( +|$\\n?)","gm"),w=this;v.selection=v.selection.replace(x,function(y,z){if(new m("^"+w.prefixes,"").test(y)){return y}return z+"\n"});v.selection=v.selection.replace(/\s+$/,"")};f.doBold=function(u,v){return this.doBorI(u,v,2,this.getString("boldexample"))};f.doItalic=function(u,v){return this.doBorI(u,v,1,this.getString("italicexample"))};f.doBorI=function(A,y,z,u){A.trimWhitespace();A.selection=A.selection.replace(/\n{2,}/g,"\n");var x=/(\**$)/.exec(A.before)[0];var v=/(^\**)/.exec(A.after)[0];var B=Math.min(x.length,v.length);if((B>=z)&&(B!=2||z!=1)){A.before=A.before.replace(m("[*]{"+z+"}$",""),"");A.after=A.after.replace(m("^[*]{"+z+"}",""),"")}else{if(!A.selection&&v){A.after=A.after.replace(/^([*_]*)/,"");A.before=A.before.replace(/(\s?)$/,"");var w=m.$1;A.before=A.before+v+w}else{if(!A.selection&&!v){A.selection=u}var C=z<=1?"*":"**";A.before=A.before+C;A.after=C+A.after}}return};f.stripLinkDefs=function(v,u){v=v.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(z,A,w,x,y){u[A]=z.replace(/\s*$/,"");if(x){u[A]=z.replace(/["(](.+?)[")]$/,"");return x+y}return""});return v};f.addLinkDef=function(B,x){var u=0;var w={};B.before=this.stripLinkDefs(B.before,w);B.selection=this.stripLinkDefs(B.selection,w);B.after=this.stripLinkDefs(B.after,w);var v="";var A=/(\[)((?:\[[^\]]*\]|[^\[\]])*)(\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g;var z=function(D){u++;D=D.replace(/^[ ]{0,3}\[(\d+)\]:/,"  ["+u+"]:");v+="\n"+D};var y=function(E,H,F,G,I,D){F=F.replace(A,y);if(w[I]){z(w[I]);return H+F+G+u+D}return E};B.before=B.before.replace(A,y);if(x){z(x)}else{B.selection=B.selection.replace(A,y)}var C=u;B.after=B.after.replace(A,y);if(B.after){B.after=B.after.replace(/\n*$/,"")}if(!B.after){B.selection=B.selection.replace(/\n*$/,"")}B.after+="\n\n"+v;return C};function n(u){return u.replace(/^\s*(.*?)(?:\s+"(.+)")?\s*$/,function(w,v,x){v=v.replace(/\?.*$/,function(y){return y.replace(/\+/g," ")});v=decodeURIComponent(v);v=encodeURI(v).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29");v=v.replace(/\?.*$/,function(y){return y.replace(/\+/g,"%2b")});if(x){x=x.trim?x.trim():x.replace(/^\s*/,"").replace(/\s*$/,"");x=x.replace(/"/g,"quot;").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}return x?v+' "'+x+'"':v})}f.doLinkOrImage=function(u,w,A,y){u.trimWhitespace();u.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);var v;if(u.endTag.length>1&&u.startTag.length>0){u.startTag=u.startTag.replace(/!?\[/,"");u.endTag="";this.addLinkDef(u,null)}else{u.selection=u.startTag+u.selection+u.endTag;u.startTag=u.endTag="";if(/\n\n/.test(u.selection)){this.addLinkDef(u,null);return}var x=this;var z=function(D){v.parentNode.removeChild(v);if(D!==null){u.selection=(" "+u.selection).replace(/([^\\](?:\\\\)*)(?=[[\]])/g,"$1\\").substr(1);var C=" [999]: "+n(D);var B=x.addLinkDef(u,C);u.startTag=A?"![":"[";u.endTag="]["+B+"]";if(!u.selection){if(A){u.selection=D}else{u.selection=x.getString("linkdescription")}}}w()};v=l.createBackground();if(A){z(y)}else{l.prompt(this.getString("linkdialog"),d,z)}return true}};f.doImage=function(v,w){filepicker.setKey(INK_API_KEY);var u;var y=new Aviary.Feather({apiKey:AVIARY_API_KEY,apiVersion:2,tools:"crop,resize,draw,text",fileFormat:"jpg",onClose:function(z){if(z){filepicker.remove(u)}},onSave:function(z,A){filepicker.storeUrl(A,function(B){filepicker.remove(u,function(){f.doLinkOrImage(v,w,true,B.url)})});y.close()},language:"pt_BR"});var x=document.getElementById("image-editor-preview");filepicker.pick({mimetype:"image/*",container:"modal",maxSize:400*1024,services:["COMPUTER","URL"]},function(z){u=z;x.src=z.url;y.launch({image:x,url:z.url})})};f.doAutoindent=function(w,x){var v=this,u=false;w.before=w.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n");w.before=w.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n");w.before=w.before.replace(/(\n|^)[ \t]+\n$/,"\n\n");if(!w.selection&&!/^[ \t]*(?:\n|$)/.test(w.after)){w.after=w.after.replace(/^[^\n]*/,function(y){w.selection=y;return""});u=true}if(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]+.*\n$/.test(w.before)){if(v.doList){v.doList(w)}}if(/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(w.before)){if(v.doBlockquote){v.doBlockquote(w)}}if(/(\n|^)(\t|[ ]{4,}).*\n$/.test(w.before)){if(v.doCode){v.doCode(w)}}if(u){w.after=w.selection+w.after;w.selection=""}};f.doBlockquote=function(B,w){B.selection=B.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(H,G,F,E){B.before+=G;B.after=E+B.after;return F});B.before=B.before.replace(/(>[ \t]*)$/,function(F,E){B.selection=E+B.selection;return""});B.selection=B.selection.replace(/^(\s|>)+$/,"");B.selection=B.selection||this.getString("quoteexample");var A="",z="",C;if(B.before){var D=B.before.replace(/\n$/,"").split("\n");var y=false;for(var x=0;x<D.length;x++){var v=false;C=D[x];y=y&&C.length>0;if(/^>/.test(C)){v=true;if(!y&&C.length>1){y=true}}else{if(/^[ \t]*$/.test(C)){v=true}else{v=y}}if(v){A+=C+"\n"}else{z+=A+C;A="\n"}}if(!/(^|\n)>/.test(A)){z+=A;A=""}}B.startTag=A;B.before=z;if(B.after){B.after=B.after.replace(/^\n?/,"\n")}B.after=B.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,function(E){B.endTag=E;return""});var u=function(F){var E=F?"> ":"";if(B.startTag){B.startTag=B.startTag.replace(/\n((>|\s)*)\n$/,function(H,G){return"\n"+G.replace(/^[ ]{0,3}>?[ \t]*$/gm,E)+"\n"})}if(B.endTag){B.endTag=B.endTag.replace(/^\n((>|\s)*)\n/,function(H,G){return"\n"+G.replace(/^[ ]{0,3}>?[ \t]*$/gm,E)+"\n"})}};if(/^(?![ ]{0,3}>)/m.test(B.selection)){this.wrap(B,o.lineLength-2);B.selection=B.selection.replace(/^/gm,"> ");u(true);B.skipLines()}else{B.selection=B.selection.replace(/^[ ]{0,3}> ?/gm,"");this.unwrap(B);u(false);if(!/^(\n|^)[ ]{0,3}>/.test(B.selection)&&B.startTag){B.startTag=B.startTag.replace(/\n{0,2}$/,"\n\n")}if(!/(\n|^)[ ]{0,3}>.*$/.test(B.selection)&&B.endTag){B.endTag=B.endTag.replace(/^\n{0,2}/,"\n\n")}}B.selection=this.hooks.postBlockquoteCreation(B.selection);if(!/\n/.test(B.selection)){B.selection=B.selection.replace(/^(> *)/,function(E,F){B.startTag+=F;return""})}};f.doCode=function(u,v){var x=/\S[ ]*$/.test(u.before);var z=/^[ ]*\S/.test(u.after);if((!z&&!x)||/\n/.test(u.selection)){u.before=u.before.replace(/[ ]{4}$/,function(A){u.selection=A+u.selection;return""});var y=1;var w=1;if(/(\n|^)(\t|[ ]{4,}).*\n$/.test(u.before)){y=0}if(/^\n(\t|[ ]{4,})/.test(u.after)){w=0}u.skipLines(y,w);if(!u.selection){u.startTag="```\n";u.selection=this.getString("codeexample");u.endTag="\n```"}else{if(/^[ ]{0,3}\S/m.test(u.selection)){u.selection="```\n"+u.selection+"\n```"}else{u.selection=u.selection.replace(/^(?:[ ]{4}|[ ]{0,3}\t)/gm,"")}}}else{u.trimWhitespace();u.findTags(/`/,/`/);if(!u.startTag&&!u.endTag){u.startTag=u.endTag="`";if(!u.selection){u.selection=this.getString("codeexample")}}else{if(u.endTag&&!u.startTag){u.before+=u.endTag;u.endTag=""}else{u.startTag=u.endTag=""}}}};f.doList=function(F,y,x){var H=/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/;var G=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/;var u="-";var C=1;var A=function(){var I;if(x){I=" "+C+". ";C++}else{I=" "+u+" "}return I};var B=function(I){if(x===undefined){x=/^\s*\d/.test(I)}I=I.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(J){return A()});return I};F.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null);if(F.before&&!/\n$/.test(F.before)&&!/^\n/.test(F.startTag)){F.before+=F.startTag;F.startTag=""}if(F.startTag){var w=/\d+[.]/.test(F.startTag);F.startTag="";F.selection=F.selection.replace(/\n[ ]{4}/g,"\n");this.unwrap(F);F.skipLines();if(w){F.after=F.after.replace(G,B)}if(x==w){return}}var z=1;F.before=F.before.replace(H,function(I){if(/^\s*([*+-])/.test(I)){u=m.$1}z=/[^\n]\n\n[^\n]/.test(I)?1:0;return B(I)});if(!F.selection){F.selection=this.getString("litem")}var D=A();var v=1;F.after=F.after.replace(G,function(I){v=/[^\n]\n\n[^\n]/.test(I)?1:0;return B(I)});F.trimWhitespace(true);F.skipLines(z,v,true);F.startTag=D;var E=D.replace(/./g," ");this.wrap(F,o.lineLength-E.length);F.selection=F.selection.replace(/\n/g,"\n"+E)};f.doHeading=function(w,x){w.selection=w.selection.replace(/\s+/g," ");w.selection=w.selection.replace(/(^\s+|\s+$)/g,"");if(!w.selection){w.startTag="## ";w.selection=this.getString("headingexample");w.endTag=" ##";return}var y=0;w.findTags(/#+[ ]*/,/[ ]*#+/);if(/#+/.test(w.startTag)){y=m.lastMatch.length}w.startTag=w.endTag="";w.findTags(null,/\s?(-+|=+)/);if(/=+/.test(w.endTag)){y=1}if(/-+/.test(w.endTag)){y=2}w.startTag=w.endTag="";w.skipLines(1,1);var z=y==0?2:y-1;if(z>0){var v=z>=2?"-":"=";var u=w.selection.length;if(u>o.lineLength){u=o.lineLength}w.endTag="\n";while(u--){w.endTag+=v}}};f.doHorizontalRule=function(u,v){u.startTag="----------\n";u.selection="";u.skipLines(2,1,true)}})();(function(){var d={newline:/^\n+/,fences:j,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:j,lheading:/^([^\n]+)\n *(=|-){3,} *\n*/,blockquote:/^( *>[^\n]+(\n[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:j,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};d.bullet=/(?:[*+-]|\d+\.)/;d.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/;d.item=c(d.item,"gm")(/bull/g,d.bullet)();d.list=c(d.list)(/bull/g,d.bullet)("hr",/\n+(?=(?: *[-*_]){3,} *(?:\n+|$))/)();d._tag="(?!(?:"+"a|em|strong|small|s|cite|q|dfn|abbr|data|time|code"+"|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo"+"|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|@)\\b";d.html=c(d.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,d._tag)();d.paragraph=c(d.paragraph)("hr",d.hr)("heading",d.heading)("lheading",d.lheading)("blockquote",d.blockquote)("tag","<"+d._tag)("def",d.def)();d.normal=g({},d);d.gfm=g({},d.normal,{fences:/^ *(`{3,}|~{3,}) *(\w+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/});d.gfm.paragraph=c(d.paragraph)("(?!","(?!"+d.gfm.fences.source.replace("\\1","\\2")+"|")();d.tables=g({},d.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/});function b(k){this.tokens=[];this.tokens.links={};this.options=k||a.defaults;this.rules=d.normal;if(this.options.gfm){if(this.options.tables){this.rules=d.tables}else{this.rules=d.gfm}}}b.rules=d;b.lex=function(m,k){var l=new b(k);return l.lex(m)};b.prototype.lex=function(k){k=k.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n");return this.token(k,true)};b.prototype.token=function(m,s){var m=m.replace(/^ +$/gm,""),q,o,u,r,t,v,k,p,n;while(m){if(u=this.rules.newline.exec(m)){m=m.substring(u[0].length);if(u[0].length>1){this.tokens.push({type:"space"})}}if(u=this.rules.fences.exec(m)){m=m.substring(u[0].length);this.tokens.push({type:"code",lang:u[2],text:u[3]});continue}if(u=this.rules.heading.exec(m)){m=m.substring(u[0].length);this.tokens.push({type:"heading",depth:u[1].length,text:u[2]});continue}if(s&&(u=this.rules.nptable.exec(m))){m=m.substring(u[0].length);v={type:"table",header:u[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:u[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:u[3].replace(/\n$/,"").split("\n")};for(p=0;p<v.align.length;p++){if(/^ *-+: *$/.test(v.align[p])){v.align[p]="right"}else{if(/^ *:-+: *$/.test(v.align[p])){v.align[p]="center"}else{if(/^ *:-+ *$/.test(v.align[p])){v.align[p]="left"}else{v.align[p]=null}}}}for(p=0;p<v.cells.length;p++){v.cells[p]=v.cells[p].split(/ *\| */)}this.tokens.push(v);continue}if(u=this.rules.lheading.exec(m)){m=m.substring(u[0].length);this.tokens.push({type:"heading",depth:u[2]==="="?1:2,text:u[1]});continue}if(u=this.rules.hr.exec(m)){m=m.substring(u[0].length);this.tokens.push({type:"hr"});continue}if(u=this.rules.blockquote.exec(m)){m=m.substring(u[0].length);this.tokens.push({type:"blockquote_start"});u=u[0].replace(/^ *> ?/gm,"");this.token(u,s);this.tokens.push({type:"blockquote_end"});continue}if(u=this.rules.list.exec(m)){m=m.substring(u[0].length);r=u[2];this.tokens.push({type:"list_start",ordered:r.length>1});u=u[0].match(this.rules.item);q=false;n=u.length;p=0;for(;p<n;p++){v=u[p];k=v.length;v=v.replace(/^ *([*+-]|\d+\.) +/,"");if(~v.indexOf("\n ")){k-=v.length;v=!this.options.pedantic?v.replace(new RegExp("^ {1,"+k+"}","gm"),""):v.replace(/^ {1,4}/gm,"")}if(this.options.smartLists&&p!==n-1){t=d.bullet.exec(u[p+1])[0];if(r!==t&&!(r.length>1&&t.length>1)){m=u.slice(p+1).join("\n")+m;p=n-1}}o=q||/\n\n(?!\s*$)/.test(v);if(p!==n-1){q=v[v.length-1]==="\n";if(!o){o=q}}this.tokens.push({type:o?"loose_item_start":"list_item_start"});this.token(v,false);this.tokens.push({type:"list_item_end"})}this.tokens.push({type:"list_end"});continue}if(u=this.rules.html.exec(m)){m=m.substring(u[0].length);this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:u[1]==="pre",text:u[0]});continue}if(s&&(u=this.rules.def.exec(m))){m=m.substring(u[0].length);this.tokens.links[u[1].toLowerCase()]={href:u[2],title:u[3]};continue}if(s&&(u=this.rules.table.exec(m))){m=m.substring(u[0].length);v={type:"table",header:u[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:u[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:u[3].replace(/(?: *\| *)?\n$/,"").split("\n")};for(p=0;p<v.align.length;p++){if(/^ *-+: *$/.test(v.align[p])){v.align[p]="right"}else{if(/^ *:-+: *$/.test(v.align[p])){v.align[p]="center"}else{if(/^ *:-+ *$/.test(v.align[p])){v.align[p]="left"}else{v.align[p]=null}}}}for(p=0;p<v.cells.length;p++){v.cells[p]=v.cells[p].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */)}this.tokens.push(v);continue}if(s&&(u=this.rules.paragraph.exec(m))){m=m.substring(u[0].length);this.tokens.push({type:"paragraph",text:u[1][u[1].length-1]==="\n"?u[1].slice(0,-1):u[1]});continue}if(u=this.rules.text.exec(m)){m=m.substring(u[0].length);this.tokens.push({type:"text",text:u[0]});continue}if(m){throw new Error("Infinite loop on byte: "+m.charCodeAt(0))}}return this.tokens};var f={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:j,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:j,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};f._inside=/(?:\[[^\]]*\]|[^\]]|\](?=[^\[]*\]))*/;f._href=/\s*<?([^\s]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/;f.link=c(f.link)("inside",f._inside)("href",f._href)();f.reflink=c(f.reflink)("inside",f._inside)();f.normal=g({},f);f.pedantic=g({},f.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/});f.gfm=g({},f.normal,{escape:c(f.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:c(f.text)("]|","~]|")("|","|https?://|")()});f.breaks=g({},f.gfm,{br:c(f.br)("{2,}","*")(),text:c(f.gfm.text)("{2,}","*")()});function h(k,l){this.options=l||a.defaults;this.links=k;this.rules=f.normal;if(!this.links){throw new Error("Tokens array requires a `links` property.")}if(this.options.gfm){if(this.options.breaks){this.rules=f.breaks}else{this.rules=f.gfm}}else{if(this.options.pedantic){this.rules=f.pedantic}}}h.rules=f;h.output=function(n,k,l){var m=new h(k,l);return m.output(n)};h.prototype.output=function(p){var l="",n,o,k,m;while(p){if(m=this.rules.escape.exec(p)){p=p.substring(m[0].length);l+=m[1];continue}if(m=this.rules.autolink.exec(p)){p=p.substring(m[0].length);if(m[2]==="@"){o=m[1][6]===":"?this.mangle(m[1].substring(7)):this.mangle(m[1]);k=this.mangle("mailto:")+o}else{o=i(m[1]);k=o}l+='<a href="'+k+'">'+o+"</a>";continue}if(m=this.rules.url.exec(p)){p=p.substring(m[0].length);o=i(m[1]);k=o;l+='<a href="'+k+'">'+o+"</a>";continue}if(m=this.rules.tag.exec(p)){p=p.substring(m[0].length);l+=this.options.sanitize?i(m[0]):m[0];continue}if(m=this.rules.link.exec(p)){p=p.substring(m[0].length);l+=this.outputLink(m,{href:m[2],title:m[3]});continue}if((m=this.rules.reflink.exec(p))||(m=this.rules.nolink.exec(p))){p=p.substring(m[0].length);n=(m[2]||m[1]).replace(/\s+/g," ");n=this.links[n.toLowerCase()];if(!n||!n.href){l+=m[0][0];p=m[0].substring(1)+p;continue}l+=this.outputLink(m,n);continue}if(m=this.rules.strong.exec(p)){p=p.substring(m[0].length);l+="<strong>"+this.output(m[2]||m[1])+"</strong>";continue}if(m=this.rules.em.exec(p)){p=p.substring(m[0].length);l+="<em>"+this.output(m[2]||m[1])+"</em>";continue}if(m=this.rules.code.exec(p)){p=p.substring(m[0].length);l+="<code>"+i(m[2],true)+"</code>";continue}if(m=this.rules.br.exec(p)){p=p.substring(m[0].length);l+="<br>";continue}if(m=this.rules.del.exec(p)){p=p.substring(m[0].length);l+="<del>"+this.output(m[1])+"</del>";continue}if(m=this.rules.text.exec(p)){p=p.substring(m[0].length);l+=i(m[0]);continue}if(p){throw new Error("Infinite loop on byte: "+p.charCodeAt(0))}}return l};h.prototype.outputLink=function(k,l){if(k[0][0]!=="!"){return'<a href="'+i(l.href)+'"'+(l.title?' title="'+i(l.title)+'"':"")+">"+this.output(k[1])+"</a>"}else{return'<img src="'+i(l.href)+'" alt="'+i(k[1])+'"'+(l.title?' title="'+i(l.title)+'"':"")+">"}};h.prototype.mangle=function(p){var m="",k=p.length,n=0,o;for(;n<k;n++){o=p.charCodeAt(n);if(Math.random()>0.5){o="x"+o.toString(16)}m+="&#"+o+";"}return m};function e(k){this.tokens=[];this.token=null;this.options=k||a.defaults}e.parse=function(l,k){var m=new e(k);return m.parse(l)};e.prototype.parse=function(l){this.inline=new h(l.links,this.options);this.tokens=l.reverse();var k="";while(this.next()){k+=this.tok()}return k};e.prototype.next=function(){return this.token=this.tokens.pop()};e.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0};e.prototype.parseText=function(){var k=this.token.text;while(this.peek().type==="text"){k+="\n"+this.next().text}return this.inline.output(k)};e.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return"<hr>\n";case"heading":return"<h"+this.token.depth+">"+this.inline.output(this.token.text)+"</h"+this.token.depth+">\n";case"code":if(this.options.highlight){var p=this.options.highlight(this.token.text,this.token.lang);if(p!=null&&p!==this.token.text){this.token.escaped=true;this.token.text=p}}if(!this.token.escaped){this.token.text=i(this.token.text,true)}return'<pre class="prettyprint"><code'+(this.token.lang?' class="'+this.options.langPrefix+this.token.lang+'"':"")+">"+this.token.text+"</code></pre>\n";case"table":var l="",q,n,r,k,m;l+="<thead>\n<tr>\n";for(n=0;n<this.token.header.length;n++){q=this.inline.output(this.token.header[n]);l+=this.token.align[n]?'<th align="'+this.token.align[n]+'">'+q+"</th>\n":"<th>"+q+"</th>\n"}l+="</tr>\n</thead>\n";l+="<tbody>\n";for(n=0;n<this.token.cells.length;n++){r=this.token.cells[n];l+="<tr>\n";for(m=0;m<r.length;m++){k=this.inline.output(r[m]);l+=this.token.align[m]?'<td align="'+this.token.align[m]+'">'+k+"</td>\n":"<td>"+k+"</td>\n"}l+="</tr>\n"}l+="</tbody>\n";return"<table>\n"+l+"</table>\n";case"blockquote_start":var l="";while(this.next().type!=="blockquote_end"){l+=this.tok()}return"<blockquote>\n"+l+"</blockquote>\n";case"list_start":var o=this.token.ordered?"ol":"ul",l="";while(this.next().type!=="list_end"){l+=this.tok()}return"<"+o+">\n"+l+"</"+o+">\n";case"list_item_start":var l="";while(this.next().type!=="list_item_end"){l+=this.token.type==="text"?this.parseText():this.tok()}return"<li>"+l+"</li>\n";case"loose_item_start":var l="";while(this.next().type!=="list_item_end"){l+=this.tok()}return"<li>"+l+"</li>\n";case"html":return !this.token.pre&&!this.options.pedantic?this.inline.output(this.token.text):this.token.text;case"paragraph":return"<p>"+this.inline.output(this.token.text)+"</p>\n";case"text":return"<p>"+this.parseText()+"</p>\n"}};function i(k,l){return k.replace(!l?/&(?!#?\w+;)/g:/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function c(m,l){m=m.source;l=l||"";return function k(n,o){if(!n){return new RegExp(m,l)}o=o.source||o;o=o.replace(/(^|[^\[])\^/g,"$1");m=m.replace(n,o);return k}}function j(){}j.exec=j;function g(n){var l=1,m,k;for(;l<arguments.length;l++){m=arguments[l];for(k in m){if(Object.prototype.hasOwnProperty.call(m,k)){n[k]=m[k]}}}return n}function a(m,k){try{if(k){k=g({},a.defaults,k)}return e.parse(b.lex(m,k),k)}catch(l){l.message+="\nPlease report this to https://github.com/chjj/marked.";if((k||a.defaults).silent){return"<p>An error occured:</p><pre>"+i(l.message+"",true)+"</pre>"}throw l}}a.options=a.setOptions=function(k){g(a.defaults,k);return a};a.defaults={gfm:true,tables:true,breaks:false,pedantic:false,sanitize:false,smartLists:false,silent:false,highlight:null,langPrefix:"lang-"};a.Parser=e;a.parser=e.parse;a.Lexer=b;a.lexer=b.lex;a.InlineLexer=h;a.inlineLexer=h.output;a.parse=a;if(typeof exports==="object"){module.exports=a}else{if(typeof define==="function"&&define.amd){define(function(){return a})}else{this.marked=a}}}).call(function(){return this||(typeof window!=="undefined"?window:global)}());(function(){var b=(function(){var g={};var f=function(a,n,m){var l=a.split(".");for(var k=0;k<l.length-1;k++){if(!m[l[k]]){m[l[k]]={}}m=m[l[k]]}if(typeof n==="function"){if(n.isClass){m[l[k]]=n}else{m[l[k]]=function(){return n.apply(g,arguments)}}}else{m[l[k]]=n}};var j=function(l,k,a){f(l,k,g);if(a){f(l,k,window.filepicker)}};var i=function(a,m,l){if(typeof a==="function"){l=m;m=a;a=""}if(a){a+="."}var k=m.call(g);for(var c in k){j(a+c,k[c],l)}};var h=function(a){a.apply(g,arguments)};return{extend:i,internal:h}})();if(!window.filepicker){window.filepicker=b}else{for(attr in b){window.filepicker[attr]=b[attr]}}})();filepicker.extend("ajax",function(){var i=this;var h=function(d,c){c.method="GET";k(d,c)};var n=function(a,d){d.method="POST";a+=(a.indexOf("?")>=0?"&":"?")+"_cacheBust="+i.util.getId();k(a,d)};var m=function(a,t){var s=[];for(var r in a){var q=a[r];if(t){r=t+"["+r+"]"}var p;switch(i.util.typeOf(q)){case"object":p=m(q,r);break;case"array":var o={};for(var d=0;d<q.length;d++){o[d]=q[d]}p=m(o,r);break;default:p=r+"="+encodeURIComponent(q);break}if(q!==null){s.push(p)}}return s.join("&")};var l=function(){try{return new window.XMLHttpRequest()}catch(b){try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(b){return null}}}};var k=function(J,I){J=J||"";var H=I.method?I.method.toUpperCase():"POST";var G=I.success||function(){};var F=I.error||function(){};var E=I.async===undefined?true:I.async;var D=I.data||null;var C=I.processData===undefined?true:I.processData;var B=I.headers||{};var A=i.util.parseUrl(J);var z=window.location.protocol+"//"+window.location.host;var y=z!==A.origin;var x=false;if(D&&C){D=m(I.data)}var w;if(I.xhr){w=I.xhr}else{w=l();if(!w){I.error("Ajax not allowed");return w}}if(y&&window.XDomainRequest&&!("withCredentials" in w)){return j(J,I)}if(I.progress&&w.upload){w.upload.addEventListener("progress",function(b){if(b.lengthComputable){I.progress(Math.round((b.loaded*95)/b.total))}},false)}var g=function(){if(w.readyState==4&&!x){if(I.progress){I.progress(100)}if(w.status>=200&&w.status<300){var c=w.responseText;if(I.json){try{c=i.json.decode(c)}catch(f){e.call(w,"Invalid json: "+c);return}}G(c,w.status,w);x=true}else{e.call(w,w.responseText);x=true}}};w.onreadystatechange=g;var e=function(b){if(x){return}if(I.progress){I.progress(100)}x=true;if(this.status==400){F("bad_params",this.status,this);return}else{if(this.status==403){F("not_authorized",this.status,this);return}else{if(this.status==404){F("not_found",this.status,this);return}}}if(y){if(this.readyState==4&&this.status===0){F("CORS_not_allowed",this.status,this);return}else{F("CORS_error",this.status,this);return}}F(b,this.status,this)};w.onerror=e;if(D&&H=="GET"){J+=(J.indexOf("?")!=-1?"&":"?")+D;D=null}w.open(H,J,E);if(I.json){w.setRequestHeader("Accept","application/json, text/javascript")}else{w.setRequestHeader("Accept","text/javascript, text/html, application/xml, text/xml, */*")}var d=B["Content-Type"]||B["content-type"];if(D&&C&&(H=="POST"||H=="PUT")&&d==undefined){w.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8")}if(B){for(var a in B){w.setRequestHeader(a,B[a])}}w.send(D);return w};var j=function(a,s){if(!window.XDomainRequest){return null}var r=s.method?s.method.toUpperCase():"POST";var q=s.success||function(){};var p=s.error||function(){};var o=s.data||{};if(window.location.protocol=="http:"){a=a.replace("https:","http:")}else{if(window.location.protocol=="https:"){a=a.replace("http:","https:")}}if(s.async){throw new i.FilepickerException("Asyncronous Cross-domain requests are not supported")}if(r!="GET"&&r!="POST"){o._method=r;r="POST"}if(s.processData!==false){o=o?m(o):null}if(o&&r=="GET"){a+=(a.indexOf("?")>=0?"&":"?")+o;o=null}a+=(a.indexOf("?")>=0?"&":"?")+"_xdr=true&_cacheBust="+i.util.getId();var d=new window.XDomainRequest();d.onload=function(){var c=d.responseText;if(s.progress){s.progress(100)}if(s.json){try{c=i.json.decode(c)}catch(e){p("Invalid json: "+c,200,d);return}}q(c,200,d)};d.onerror=function(){if(s.progress){s.progress(100)}p(d.responseText||"CORS_error",this.status||500,this)};d.onprogress=function(){};d.ontimeout=function(){};d.timeout=30000;d.open(r,a,true);d.send(o);return d};return{get:h,post:n,request:k}});filepicker.extend("base64",function(){var g=this;_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var f=function(v,u){u=u||u===undefined;var t="";var s,r,q,p,o,n,m;var d=0;if(u){v=i(v)}while(d<v.length){s=v.charCodeAt(d);r=v.charCodeAt(d+1);q=v.charCodeAt(d+2);d+=3;p=s>>2;o=((s&3)<<4)|(r>>4);n=((r&15)<<2)|(q>>6);m=q&63;if(isNaN(r)){n=m=64}else{if(isNaN(q)){m=64}}t=t+_keyStr.charAt(p)+_keyStr.charAt(o)+_keyStr.charAt(n)+_keyStr.charAt(m)}return t};var j=function(v,u){u=u||u===undefined;var t="";var s,r,q;var p,o,n,m;var e=0;v=v.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(e<v.length){p=_keyStr.indexOf(v.charAt(e));o=_keyStr.indexOf(v.charAt(e+1));n=_keyStr.indexOf(v.charAt(e+2));m=_keyStr.indexOf(v.charAt(e+3));e+=4;s=(p<<2)|(o>>4);r=((o&15)<<4)|(n>>2);q=((n&3)<<6)|m;t=t+String.fromCharCode(s);if(n!=64){t=t+String.fromCharCode(r)}if(m!=64){t=t+String.fromCharCode(q)}}if(u){t=h(t)}return t};var i=function(k){k=k.replace(/\r\n/g,"\n");var e="";for(var m=0;m<k.length;m++){var l=k.charCodeAt(m);if(l<128){e+=String.fromCharCode(l)}else{if((l>127)&&(l<2048)){e+=String.fromCharCode((l>>6)|192);e+=String.fromCharCode((l&63)|128)}else{e+=String.fromCharCode((l>>12)|224);e+=String.fromCharCode(((l>>6)&63)|128);e+=String.fromCharCode((l&63)|128)}}}return e};var h=function(k){var e="";var m=0;var l=c1=c2=0;while(m<k.length){l=k.charCodeAt(m);if(l<128){e+=String.fromCharCode(l);m++}else{if((l>191)&&(l<224)){c2=k.charCodeAt(m+1);e+=String.fromCharCode(((l&31)<<6)|(c2&63));m+=2}else{c2=k.charCodeAt(m+1);c3=k.charCodeAt(m+2);e+=String.fromCharCode(((l&15)<<12)|((c2&63)<<6)|(c3&63));m+=3}}}return e};return{encode:f,decode:j}},true);filepicker.extend("browser",function(){var f=this;var e=function(){return !!(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))};var h=function(){return !!navigator.userAgent.match(/Android/i)};var g=function(){return !!navigator.userAgent.match(/MSIE 7\.0/i)};return{isIOS:e,isAndroid:h,isIE7:g}});filepicker.extend("comm",function(){var i=this;var h="filepicker_comm_iframe";var n=function(){if(window.frames[h]===undefined){k();var a;a=document.createElement("iframe");a.id=a.name=h;a.src=i.urls.COMM;a.style.display="none";document.body.appendChild(a)}};var m=function(a){if(a.origin!=i.urls.BASE){return}var d=i.json.parse(a.data);i.handlers.run(d)};var l=false;var k=function(){if(l){return}else{l=true}if(window.addEventListener){window.addEventListener("message",m,false)}else{if(window.attachEvent){window.attachEvent("onmessage",m)}else{throw new i.FilepickerException("Unsupported browser")}}};var j=function(){if(window.removeEventListener){window.removeEventListener("message",m,false)}else{if(window.attachEvent){window.detachEvent("onmessage",m)}else{throw new i.FilepickerException("Unsupported browser")}}if(!l){return}else{l=false}var d=document.getElementsByName(h);for(var b=0;b<d.length;b++){d[b].parentNode.removeChild(d[b])}try{delete window.frames[h]}catch(a){}};return{openChannel:n,closeChannel:j}});filepicker.extend("comm_fallback",function(){var L=this;var K="filepicker_comm_iframe";var J="host_comm_iframe";var I="";var H=200;var G=function(){F()};var F=function(){if(window.frames[J]===undefined){var a;a=document.createElement("iframe");a.id=a.name=J;I=a.src=L.urls.constructHostCommFallback();a.style.display="none";var c=function(){I=a.contentWindow.location.href;E()};if(a.attachEvent){a.attachEvent("onload",c)}else{a.onload=c}document.body.appendChild(a)}};var E=function(){if(window.frames[K]===undefined){var a;a=document.createElement("iframe");a.id=a.name=K;a.src=L.urls.FP_COMM_FALLBACK+"?host_url="+encodeURIComponent(I);a.style.display="none";document.body.appendChild(a)}z()};var D=false;var C=undefined;var B="";var A=function(){var j=window.frames[K];if(!j){return}var i=j.frames[J];if(!i){return}var c=i.location.hash;if(c&&c.charAt(0)=="#"){c=c.substr(1)}if(c===B){return}B=c;if(!B){return}var b;try{b=L.json.parse(c)}catch(a){}if(b){L.handlers.run(b)}};var z=function(){if(D){return}else{D=true}C=window.setInterval(A,H)};var y=function(){window.clearInterval(C);if(!D){return}else{D=false}var b=document.getElementsByName(K);for(var f=0;f<b.length;f++){b[f].parentNode.removeChild(b[f])}try{delete window.frames[K]}catch(c){}b=document.getElementsByName(J);for(f=0;f<b.length;f++){b[f].parentNode.removeChild(b[f])}try{delete window.frames[J]}catch(c){}};var x=!("postMessage" in window);var w=function(b){if(b!==x){x=!!b;if(x){u()}else{t()}}};var v;var u=function(){v=L.comm;L.comm={openChannel:G,closeChannel:y}};var t=function(){L.comm=v;v=undefined};if(x){u()}return{openChannel:G,closeChannel:y,isEnabled:x}});filepicker.extend("conversions",function(){var f=this;var e={width:"number",height:"number",fit:"string",format:"string",watermark:"string",watermark_size:"number",watermark_position:"string",align:"string",crop:"string or array",quality:"number",text:"string",text_font:"string",text_size:"number",text_color:"string",text_align:"string",text_padding:"number",policy:"string",signature:"string",storeLocation:"string",storePath:"string",storeAccess:"string",rotate:"string or number"};var h=function(j){var i;for(var b in j){i=false;for(var a in e){if(b==a){i=true;if(e[a].indexOf(f.util.typeOf(j[b]))===-1){throw new f.FilepickerException("Conversion parameter "+b+" is not the right type: "+j[b]+". Should be a "+e[a])}}}if(!i){throw new f.FilepickerException("Conversion parameter "+b+" is not a valid parameter.")}}};var g=function(a,k,j,i,c){h(k);if(k.crop&&f.util.isArray(k.crop)){k.crop=k.crop.join(",")}f.ajax.post(a+"/convert",{data:k,json:true,success:function(d){j(f.util.standardizeFPFile(d))},error:function(l,n,m){if(l=="not_found"){i(new f.errors.FPError(141))}else{if(l=="bad_params"){i(new f.errors.FPError(142))}else{if(l=="not_authorized"){i(new f.errors.FPError(403))}else{i(new f.errors.FPError(143))}}}},progress:c})};return{convert:g}});filepicker.extend("cookies",function(){var e=this;var d=function(a){var g=function(b){if(b.type!=="ThirdPartyCookies"){return}e.cookies.THIRD_PARTY_COOKIES=!!b.payload;if(a&&typeof a==="function"){a(!!b.payload)}};return g};var f=function(b){var a=d(b);e.handlers.attach("cookies",a);e.comm.openChannel()};return{checkThirdParty:f}});filepicker.extend("dragdrop",function(){var e=this;var d=function(){return(!!window.FileReader||navigator.userAgent.indexOf("Safari")>=0)&&("draggable" in document.createElement("span"))};var f=function(L,K){var J="No DOM element found to create drop pane";if(!L){throw new e.FilepickerException(J)}if(L.jquery){if(L.length===0){throw new e.FilepickerException(J)}L=L[0]}if(!d()){e.util.console.error("Your browser doesn't support drag-drop functionality");return false}K=K||{};var I=K.dragEnter||function(){};var H=K.dragLeave||function(){};var G=K.onStart||function(){};var F=K.onSuccess||function(){};var E=K.onError||function(){};var D=K.onProgress||function(){};var C=K.mimetypes;if(!C){if(K.mimetype){C=[K.mimetype]}else{C=["*/*"]}}if(e.util.typeOf(C)=="string"){C=C.split(",")}var B=K.extensions;if(!B){if(K.extension){B=[K.extensions]}}if(e.util.typeOf(B)=="string"){B=B.split(",")}var A={location:K.location,path:K.path,access:K.access,policy:K.policy,signature:K.signature};L.addEventListener("dragenter",function(c){I();c.stopPropagation();c.preventDefault();return false},false);L.addEventListener("dragleave",function(c){H();c.stopPropagation();c.preventDefault();return false},false);L.addEventListener("dragover",function(c){c.preventDefault();return false},false);L.addEventListener("drop",function(h){h.stopPropagation();h.preventDefault();var m;var l;var k;if(h.dataTransfer.items){l=h.dataTransfer.items;for(m=0;m<l.length;m++){k=l[m]&&l[m].webkitGetAsEntry?l[m].webkitGetAsEntry():undefined;if(k&&!!k.isDirectory){E("WrongType","Uploading a folder is not allowed");return}}}var j=h.dataTransfer.files;var i=j.length;if(a(j)){G(j);for(m=0;m<j.length;m++){e.store(j[m],A,x(m,i),w,v(m,i))}}});var z={};var y=[];var x=function(g,c){return function(h){if(!K.multiple){F([h])}else{y.push(h);if(y.length==c){F(y);y=[]}else{z[g]=100;b(c)}}}};var w=function(c){E("UploadError",c.toString())};var v=function(g,c){return function(h){z[g]=h;b(c)}};var b=function(h){var g=0;for(var j in z){g+=z[j]}var i=g/h;D(i)};var a=function(j){if(j.length>0){if(j.length>1&&!K.multiple){E("TooManyFiles","Only one file at a time");return false}var p;var o;var n;for(var m=0;m<j.length;m++){p=false;o=j[m];n=o.name||o.fileName||'"Unknown file"';for(var l=0;l<C.length;l++){var k=e.mimetypes.getMimetype(o);p=p||e.mimetypes.matchesMimetype(k,C[l])}if(!p){E("WrongType",n+" isn't the right type of file");return false}if(B){p=false;for(l=0;l<B.length;l++){p=p||e.util.endsWith(n,B[l])}if(!p){E("WrongType",n+" isn't the right type of file");return false}}if(o.size&&!!K.maxSize&&o.size>K.maxSize){E("WrongSize",n+" is too large ("+o.size+" Bytes)");return false}}return true}else{E("NoFilesFound","No files uploaded")}return false};return true};return{enabled:d,makeDropPane:f}});filepicker.extend("errors",function(){var e=this;var d=function(b){if(this===window){return new d(b)}this.code=b;if(filepicker.debug){var g=filepicker.error_map[this.code];this.message=g.message;this.moreInfo=g.moreInfo;this.toString=function(){return"FPError "+this.code+": "+this.message+". For help, see "+this.moreInfo}}else{this.toString=function(){return"FPError "+this.code+". Include filepicker_debug.js for more info"}}return this};d.isClass=true;var f=function(a){if(filepicker.debug){e.util.console.error(a.toString())}};return{FPError:d,handleError:f}},true);filepicker.extend("exporter",function(){var f=this;var e=function(a){var l=function(n,m,b){if(a[m]&&!f.util.isArray(a[m])){a[m]=[a[m]]}else{if(a[n]){a[m]=[a[n]]}else{if(b){a[m]=b}}}};if(a.mimetype&&a.extension){throw f.FilepickerException("Error: Cannot pass in both mimetype and extension parameters to the export function")}l("service","services");if(a.services){for(var k=0;k<a.services.length;k++){var j=(""+a.services[k]).replace(" ","");var i=f.services[j];a.services[k]=(i===undefined?j:i)}}if(a.openTo){a.openTo=f.services[a.openTo]||a.openTo}f.util.setDefault(a,"container","modal")};var h=function(a,j){var i=function(c){if(c.type!=="filepickerUrl"){return}if(c.error){f.util.console.error(c.error);j(f.errors.FPError(132))}else{var b={};b.url=c.payload.url;b.filename=c.payload.data.filename;b.mimetype=c.payload.data.type;b.size=c.payload.data.size;b.isWriteable=true;a(b)}f.modal.close()};return i};var g=function(r,q,p,o){e(q);if(q.debug){setTimeout(function(){p({url:"https://www.filepicker.io/api/file/-nBq2onTSemLBxlcBWn1",filename:"test.png",mimetype:"image/png",size:58979})},1);return}if(f.cookies.THIRD_PARTY_COOKIES===undefined){f.cookies.checkThirdParty(function(){g(r,q,p,o)});return}var n=f.util.getId();var d=false;var c=function(i){d=true;p(i)};var b=function(i){d=true;o(i)};var a=function(){if(!d){d=true;o(f.errors.FPError(131))}};if(q.container=="modal"&&(q.mobile||f.window.shouldForce())){q.container="window"}f.window.open(q.container,f.urls.constructExportUrl(r,q,n),a);f.handlers.attach(n,h(c,b))};return{createExporter:g}});filepicker.extend("files",function(){var D=this;var C=function(a,n,m,l,k){var j=n.base64encode===undefined;if(j){n.base64encode=true}n.base64encode=n.base64encode!==false;var c=function(d){if(j){d=D.base64.decode(d,!!n.asText)}m(d)};B.call(this,a,n,c,l,k)};var B=function(a,j,i,h,g){if(j.cache!==true){j._cacheBust=D.util.getId()}D.ajax.get(a,{data:j,headers:{"X-NO-STREAM":true},success:i,error:function(e,k,f){if(e=="CORS_not_allowed"){h(new D.errors.FPError(113))}else{if(e=="CORS_error"){h(new D.errors.FPError(114))}else{if(e=="not_found"){h(new D.errors.FPError(115))}else{if(e=="bad_params"){h(new D.errors.FPError(400))}else{if(e=="not_authorized"){h(new D.errors.FPError(403))}else{h(new D.errors.FPError(118))}}}}}},progress:g})};var A=function(a,E,o,n,m){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob)){m(10);D.files.storeFile(a,{},function(c){m(50);D.files.readFromFPUrl(c.url,E,o,n,function(b){m(50+b/2)})},n,function(b){m(b/2)});return}var l=!!E.base64encode;var k=!!E.asText;var j=new FileReader();j.onprogress=function(b){if(b.lengthComputable){m(Math.round((b.loaded/b.total)*100))}};j.onload=function(c){m(100);if(l){o(D.base64.encode(c.target.result,k))}else{o(c.target.result)}};j.onerror=function(c){switch(c.target.error.code){case c.target.error.NOT_FOUND_ERR:n(new D.errors.FPError(115));break;case c.target.error.NOT_READABLE_ERR:n(new D.errors.FPError(116));break;case c.target.error.ABORT_ERR:n(new D.errors.FPError(117));break;default:n(new D.errors.FPError(118));break}};if(k||!j.readAsBinaryString){j.readAsText(a)}else{j.readAsBinaryString(a)}};var z=function(a,n,m,l,k,j){var i=m.mimetype||"text/plain";D.ajax.post(D.urls.constructWriteUrl(a,m),{headers:{"Content-Type":i},data:n,processData:false,json:true,success:function(c){l(D.util.standardizeFPFile(c))},error:function(e,g,f){if(e=="not_found"){k(new D.errors.FPError(121))}else{if(e=="bad_params"){k(new D.errors.FPError(122))}else{if(e=="not_authorized"){k(new D.errors.FPError(403))}else{k(new D.errors.FPError(123))}}}},progress:j})};var y=function(a,E,o,n,m,l){var k=function(e,g,f){if(e=="not_found"){m(new D.errors.FPError(121))}else{if(e=="bad_params"){m(new D.errors.FPError(122))}else{if(e=="not_authorized"){m(new D.errors.FPError(403))}else{m(new D.errors.FPError(123))}}}};var j=function(c){n(D.util.standardizeFPFile(c))};t(E,D.urls.constructWriteUrl(a,o),j,k,l)};var x=function(a,E,o,n,m,l){var k=function(e,g,f){if(e=="not_found"){m(new D.errors.FPError(121))}else{if(e=="bad_params"){m(new D.errors.FPError(122))}else{if(e=="not_authorized"){m(new D.errors.FPError(403))}else{m(new D.errors.FPError(123))}}}};var j=function(c){n(D.util.standardizeFPFile(c))};o.mimetype=E.type;t(E,D.urls.constructWriteUrl(a,o),j,k,l)};var w=function(a,l,k,j,i,h){D.ajax.post(D.urls.constructWriteUrl(a,k),{data:{"url":l},json:true,success:function(c){j(D.util.standardizeFPFile(c))},error:function(e,g,f){if(e=="not_found"){i(new D.errors.FPError(121))}else{if(e=="bad_params"){i(new D.errors.FPError(122))}else{if(e=="not_authorized"){i(new D.errors.FPError(403))}else{i(new D.errors.FPError(123))}}}},progress:h})};var v=function(a,l,k,j,i){if(a.files){if(a.files.length===0){j(new D.errors.FPError(115))}else{u(a.files[0],l,k,j,i)}return}D.util.setDefault(l,"storage","S3");if(!l.filename){l.filename=a.value.replace("C:\\fakepath\\","")||a.name}var h=a.name;a.name="fileUpload";D.iframeAjax.post(D.urls.constructStoreUrl(l),{data:a,processData:false,json:true,success:function(b){a.name=h;k(D.util.standardizeFPFile(b))},error:function(e,g,f){if(e=="not_found"){j(new D.errors.FPError(121))}else{if(e=="bad_params"){j(new D.errors.FPError(122))}else{if(e=="not_authorized"){j(new D.errors.FPError(403))}else{j(new D.errors.FPError(123))}}}}})};var u=function(a,n,m,l,k){D.util.setDefault(n,"storage","S3");var j=function(e,g,f){if(e=="not_found"){l(new D.errors.FPError(121))}else{if(e=="bad_params"){l(new D.errors.FPError(122))}else{if(e=="not_authorized"){l(new D.errors.FPError(403))}else{D.util.console.error(e);l(new D.errors.FPError(123))}}}};var i=function(c){m(D.util.standardizeFPFile(c))};if(!n.filename){n.filename=a.name||a.fileName}t(a,D.urls.constructStoreUrl(n),i,j,k)};var t=function(a,l,k,j,i){if(a.files){a=a.files[0]}var h=!!window.FormData&&!!window.XMLHttpRequest;if(h){data=new FormData();data.append("fileUpload",a);D.ajax.post(l,{json:true,processData:false,data:data,success:k,error:j,progress:i})}else{D.iframeAjax.post(l,{data:a,json:true,success:k,error:j})}};var s=function(a,j,i,h,g){D.util.setDefault(j,"storage","S3");D.util.setDefault(j,"mimetype","text/plain");D.ajax.post(D.urls.constructStoreUrl(j),{headers:{"Content-Type":j.mimetype},data:a,processData:false,json:true,success:function(c){i(D.util.standardizeFPFile(c))},error:function(e,k,f){if(e=="not_found"){h(new D.errors.FPError(121))}else{if(e=="bad_params"){h(new D.errors.FPError(122))}else{if(e=="not_authorized"){h(new D.errors.FPError(403))}else{h(new D.errors.FPError(123))}}}},progress:g})};var r=function(a,j,i,h,g){D.util.setDefault(j,"storage","S3");D.ajax.post(D.urls.constructStoreUrl(j),{data:{"url":a},json:true,success:function(c){i(D.util.standardizeFPFile(c))},error:function(e,k,f){if(e=="not_found"){h(new D.errors.FPError(151))}else{if(e=="bad_params"){h(new D.errors.FPError(152))}else{if(e=="not_authorized"){h(new D.errors.FPError(403))}else{h(new D.errors.FPError(153))}}}},progress:g})};var q=function(a,j,i,h){var g=["uploaded","modified","created"];if(j.cache!==true){j._cacheBust=D.util.getId()}D.ajax.get(a+"/metadata",{json:true,data:j,success:function(d){for(var c=0;c<g.length;c++){if(d[g[c]]){d[g[c]]=new Date(d[g[c]])}}i(d)},error:function(e,k,f){if(e=="not_found"){h(new D.errors.FPError(161))}else{if(e=="bad_params"){h(new D.errors.FPError(400))}else{if(e=="not_authorized"){h(new D.errors.FPError(403))}else{h(new D.errors.FPError(162))}}}}})};var p=function(a,h,g,f){h.key=D.apikey;D.ajax.post(a+"/remove",{data:h,success:function(b){g()},error:function(e,j,i){if(e=="not_found"){f(new D.errors.FPError(171))}else{if(e=="bad_params"){f(new D.errors.FPError(400))}else{if(e=="not_authorized"){f(new D.errors.FPError(403))}else{f(new D.errors.FPError(172))}}}}})};return{readFromUrl:B,readFromFile:A,readFromFPUrl:C,writeDataToFPUrl:z,writeFileToFPUrl:x,writeFileInputToFPUrl:y,writeUrlToFPUrl:w,storeFileInput:v,storeFile:u,storeUrl:r,storeData:s,stat:q,remove:p}});filepicker.extend("handlers",function(){var g=this;var f={};var j=function(b,d){if(f.hasOwnProperty(b)){f[b].push(d)}else{f[b]=[d]}return d};var i=function(b,m){var l=f[b];if(!l){return}if(m){for(var k=0;k<l.length;k++){if(l[k]===m){l.splice(k,1);break}}if(l.length===0){delete f[b]}}else{delete f[b]}};var h=function(b){var m=b.id;if(f.hasOwnProperty(m)){var l=f[m];for(var k=0;k<l.length;k++){l[k](b)}return true}return false};return{attach:j,detach:i,run:h}});filepicker.extend("iframeAjax",function(){var t=this;var s="ajax_iframe";var r=[];var q=false;var p=function(d,c){c.method="GET";m(d,c)};var o=function(a,d){d.method="POST";a+=(a.indexOf("?")>=0?"&":"?")+"_cacheBust="+t.util.getId();m(a,d)};var n=function(){if(r.length>0){var b=r.shift();m(b.url,b.options)}};var m=function(z,y){if(q){r.push({url:z,options:y});return}z+=(z.indexOf("?")>=0?"&":"?")+"_cacheBust="+t.util.getId();z+="&Content-Type=text%2Fhtml";t.comm.openChannel();var x;try{x=document.createElement('<iframe name="'+s+'">')}catch(w){x=document.createElement("iframe")}x.id=x.name=s;x.style.display="none";var v=function(){q=false};if(x.attachEvent){x.attachEvent("onload",v);x.attachEvent("onerror",v)}else{x.onerror=x.onload=v}x.id=s;x.name=s;x.style.display="none";x.onerror=x.onload=function(){q=false};document.body.appendChild(x);t.handlers.attach("upload",l(y));var u=document.createElement("form");u.method=y.method||"GET";u.action=z;u.target=s;var j=y.data;if(t.util.isFileInputElement(j)||t.util.isFile(j)){u.encoding=u.enctype="multipart/form-data"}document.body.appendChild(u);if(t.util.isFile(j)){var i=k(j);if(!i){throw t.FilepickerException("Couldn't find corresponding file input.")}j={"fileUpload":i}}else{if(t.util.isFileInputElement(j)){var d=j;j={};j.fileUpload=d}else{if(j&&t.util.isElement(j)&&j.tagName=="INPUT"){d=j;j={};j[d.name]=d}else{if(y.processData!==false){j={"data":j}}}}}j.format="iframe";var c={};for(var b in j){var a=j[b];if(t.util.isElement(a)&&a.tagName=="INPUT"){c[b]={par:a.parentNode,sib:a.nextSibling,name:a.name,input:a,focused:a==document.activeElement};a.name=b;u.appendChild(a)}else{var A=document.createElement("input");A.name=b;A.value=a;u.appendChild(A)}}q=true;window.setTimeout(function(){u.submit();for(var f in c){var e=c[f];e.par.insertBefore(e.input,e.sib);e.input.name=e.name;if(e.focused){e.input.focus()}}u.parentNode.removeChild(u)},1)};var l=function(a){var h=a.success||function(){};var g=a.error||function(){};var d=function(c){if(c.type!=="Upload"){return}q=false;var e=c.payload;if(e.error){g(e.error)}else{h(e)}t.handlers.detach("upload");n()};return d};var k=function(g){var f=document.getElementsByTagName("input");for(var j=0;j<f.length;j++){var i=f[0];if(i.type!="file"||!i.files||!i.files.length){continue}for(var h=0;h<i.files.length;h++){if(i.files[h]===g){return i}}}return null};return{get:p,post:o,request:m}});filepicker.extend("json",function(){var a=this;var b={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};var c=function(a){return b[a]||"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)};var d=function(a){a=a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");return(/^[\],:{}\s]*$/).test(a)};var e=function(b){if(window.JSON&&window.JSON.stringify){return window.JSON.stringify(b)}if(b&&b.toJSON){b=b.toJSON()}var d=[];switch(a.util.typeOf(b)){case"string":return'"'+b.replace(/[\x00-\x1f\\"]/g,c)+'"';case"array":for(var f=0;f<b.length;f++){d.push(e(b[f]))}return"["+d+"]";case"object":case"hash":var g;var h;for(h in b){g=e(b[h]);if(g){d.push(e(h)+":"+g)}g=null}return"{"+d+"}";case"number":case"boolean":return""+b;case"null":return"null";default:return"null"}return null};var f=function(b,c){if(!b||a.util.typeOf(b)!="string"){return null}if(window.JSON&&window.JSON.parse){return window.JSON.parse(b)}else{if(c){if(!d(b)){throw new Error("JSON could not decode the input; security is enabled and the value is not secure.")}}return eval("("+b+")")}};return{validate:d,encode:e,stringify:e,decode:f,parse:f}});filepicker.extend(function(){var L=this;L.API_VERSION="v1";var K=function(a){L.apikey=a};var J=function(b){this.text=b;this.toString=function(){return"FilepickerException: "+this.text};return this};J.isClass=true;var I=function(){if(!L.apikey){throw new L.FilepickerException("API Key not found")}};var H=function(a,f,d){I();if(typeof a==="function"){d=f;f=a;a={}}a=a||{};f=f||function(){};d=d||L.errors.handleError;L.picker.createPicker(a,f,d,false)};var G=function(a,f,d){I();if(typeof a==="function"){d=f;f=a;a={}}a=a||{};f=f||function(){};d=d||L.errors.handleError;L.picker.createPicker(a,f,d,true)};var F=function(a,n,m,l){I();if(!a||!n||typeof a==="function"||typeof a==="function"){throw new L.FilepickerException("Not all required parameters given, missing picker or store options")}l=l||L.errors.handleError;var k=!!a.multiple;var j=!!a?L.util.clone(a):{};j.storeLocation=n.location||"S3";j.storePath=n.path;j.storeAccess=n.access||"private";if(k&&j.storePath){if(j.storePath.charAt(j.storePath.length-1)!="/"){throw new L.FilepickerException("pickAndStore with multiple files requires a path that ends in '/'")}}var d=m;if(!k){d=function(b){m([b])}}L.picker.createPicker(j,d,l,k)};var E=function(a,j,i,h,d){I();if(!a){throw new L.FilepickerException("No input given - nothing to read!")}if(typeof j==="function"){d=h;h=i;i=j;j={}}j=j||{};i=i||function(){};h=h||L.errors.handleError;d=d||function(){};if(typeof a=="string"){if(L.util.isFPUrl(a)){L.files.readFromFPUrl(a,j,i,h,d)}else{L.files.readFromUrl(a,j,i,h,d)}}else{if(L.util.isFileInputElement(a)){if(!a.files){D(a,j,i,h,d)}else{if(a.files.length===0){h(new L.errors.FPError(115))}else{L.files.readFromFile(a.files[0],j,i,h,d)}}}else{if(L.util.isFile(a)){L.files.readFromFile(a,j,i,h,d)}else{if(a.url){L.files.readFromFPUrl(a.url,j,i,h,d)}else{throw new L.FilepickerException("Cannot read given input: "+a+". Not a url, file input, DOM File, or FPFile object.")}}}}};var D=function(a,j,i,h,g){g(10);L.store(a,function(c){g(50);L.read(c,j,i,h,function(b){g(50+b/2)})},h)};var C=function(a,n,m,l,k,j){I();if(!a){throw new L.FilepickerException("No fpfile given - nothing to write to!")}if(n===undefined||n===null){throw new L.FilepickerException("No input given - nothing to write!")}if(typeof m==="function"){j=k;k=l;l=m;m={}}m=m||{};l=l||function(){};k=k||L.errors.handleError;j=j||function(){};var d;if(L.util.isFPUrl(a)){d=a}else{if(a.url){d=a.url}else{throw new L.FilepickerException("Invalid file to write to: "+a+". Not a filepicker url or FPFile object.")}}if(typeof n=="string"){L.files.writeDataToFPUrl(d,n,m,l,k,j)}else{if(L.util.isFileInputElement(n)){if(!n.files){L.files.writeFileInputToFPUrl(d,n,m,l,k,j)}else{if(n.files.length===0){k(new L.errors.FPError(115))}else{L.files.writeFileToFPUrl(d,n.files[0],m,l,k,j)}}}else{if(L.util.isFile(n)){L.files.writeFileToFPUrl(d,n,m,l,k,j)}else{if(n.url){L.files.writeUrlToFPUrl(d,n.url,m,l,k,j)}else{throw new L.FilepickerException("Cannot read from given input: "+n+". Not a string, file input, DOM File, or FPFile object.")}}}}};var B=function(a,n,m,l,k,j){I();if(!a){throw new L.FilepickerException("No fpfile given - nothing to write to!")}if(n===undefined||n===null){throw new L.FilepickerException("No input given - nothing to write!")}if(typeof m==="function"){j=k;k=l;l=m;m={}}m=m||{};l=l||function(){};k=k||L.errors.handleError;j=j||function(){};var d;if(L.util.isFPUrl(a)){d=a}else{if(a.url){d=a.url}else{throw new L.FilepickerException("Invalid file to write to: "+a+". Not a filepicker url or FPFile object.")}}L.files.writeUrlToFPUrl(d,n,m,l,k,j)};var A=function(a,j,i,h){I();if(typeof j==="function"){h=i;i=j;j={}}j=!!j?L.util.clone(j):{};i=i||function(){};h=h||L.errors.handleError;var d;if(typeof a=="string"&&L.util.isUrl(a)){d=a}else{if(a.url){d=a.url;if(!j.mimetype&&!j.extension){j.mimetype=a.mimetype}if(!j.suggestedFilename){j.suggestedFilename=a.filename}}else{throw new L.FilepickerException("Invalid file to export: "+a+". Not a valid url or FPFile object. You may want to use filepicker.store() to get an FPFile to export")}}L.exporter.createExporter(d,j,i,h)};var z=function(a,j,i,h,d){I();if(typeof j==="function"){d=h;h=i;i=j;j={}}j=!!j?L.util.clone(j):{};i=i||function(){};h=h||L.errors.handleError;d=d||function(){};if(typeof a=="string"){L.files.storeData(a,j,i,h,d)}else{if(L.util.isFileInputElement(a)){if(!a.files){L.files.storeFileInput(a,j,i,h,d)}else{if(a.files.length===0){h(new L.errors.FPError(115))}else{L.files.storeFile(a.files[0],j,i,h,d)}}}else{if(L.util.isFile(a)){L.files.storeFile(a,j,i,h,d)}else{if(a.url){if(!j.filename){j.filename=a.filename}L.files.storeUrl(a.url,j,i,h,d)}else{throw new L.FilepickerException("Cannot store given input: "+a+". Not a string, file input, DOM File, or FPFile object.")}}}}};var y=function(a,j,i,h,d){I();if(typeof j==="function"){d=h;h=i;i=j;j={}}j=j||{};i=i||function(){};h=h||L.errors.handleError;d=d||function(){};L.files.storeUrl(a,j,i,h,d)};var x=function(a,j,i,h){I();if(typeof j==="function"){h=i;i=j;j={}}j=j||{};i=i||function(){};h=h||L.errors.handleError;var d;if(L.util.isFPUrl(a)){d=a}else{if(a.url){d=a.url}else{throw new L.FilepickerException("Invalid file to get metadata for: "+a+". Not a filepicker url or FPFile object.")}}L.files.stat(d,j,i,h)};var w=function(a,j,i,h){I();if(typeof j==="function"){h=i;i=j;j={}}j=j||{};i=i||function(){};h=h||L.errors.handleError;var d;if(L.util.isFPUrl(a)){d=a}else{if(a.url){d=a.url}else{throw new L.FilepickerException("Invalid file to remove: "+a+". Not a filepicker url or FPFile object.")}}L.files.remove(d,j,i,h)};var v=function(a,n,m,l,k,j){I();if(!a){throw new L.FilepickerException("No fpfile given - nothing to convert!")}if(typeof m==="function"){j=k;k=l;l=m;m={}}options=!!n?L.util.clone(n):{};m=m||{};l=l||function(){};k=k||L.errors.handleError;j=j||function(){};if(m.location){options.storeLocation=m.location}if(m.path){options.storePath=m.path}options.storeAccess=m.access||"private";var d;if(L.util.isFPUrl(a)){d=a}else{if(a.url){d=a.url;if(!L.mimetypes.matchesMimetype(a.mimetype,"image/*")){k(new L.errors.FPError(142));return}}else{throw new L.FilepickerException("Invalid file to convert: "+a+". Not a filepicker url or FPFile object.")}}L.conversions.convert(d,options,l,k,j)};var u=function(a){return L.widgets.constructWidget(a)};var t=function(a,d){return L.dragdrop.makeDropPane(a,d)};return{setKey:K,pick:H,pickMultiple:G,pickAndStore:F,read:E,write:C,writeUrl:B,"export":A,exportFile:A,store:z,storeUrl:y,stat:x,metadata:x,remove:w,convert:v,constructWidget:u,makeDropPane:t,FilepickerException:J}},true);filepicker.extend("mimetypes",function(){var g=this;var f={".stl":"applicaiton/sla",".hbs":"text/html",".pdf":"application/pdf",".jpg":"image/jpeg",".jpeg":"image/jpeg",".jpe":"image/jpeg",".imp":"application/x-impressionist"};var j=["application/octet-stream","application/download","application/force-download","octet/stream","application/unknown","application/x-download","application/x-msdownload","application/x-secure-download"];var i=function(b){if(b.type){var n=b.type;n=n.toLowerCase();var m=false;for(var l=0;l<j.length;l++){m=m||n==j[l]}if(!m){return b.type}}var k=b.name||b.fileName;var c=k.match(/\.\w*$/);if(c){return f[c[0].toLowerCase()]||""}else{if(b.type){return b.type}else{return""}}};var h=function(a,k){if(!a){return k=="*/*"}a=g.util.trim(a).toLowerCase();k=g.util.trim(k).toLowerCase();for(var c=0;c<j.length;c++){if(a==j[c]){return true}}test_parts=a.split("/");against_parts=k.split("/");if(against_parts[0]=="*"){return true}if(against_parts[0]!=test_parts[0]){return false}if(against_parts[1]=="*"){return true}return against_parts[1]==test_parts[1]};return{getMimetype:i,matchesMimetype:h}});filepicker.extend("modal",function(){var r=this;var q="filepicker_shade";var p="filepicker_dialog_container";var o=function(a,v){var u=n(v);var t=m();var s=l(v);var g=document.createElement("iframe");g.name=r.window.WINDOW_NAME;g.id=r.window.WINDOW_NAME;var f=r.window.getSize();var e=Math.min(f[1]-40,500);g.style.width="100%";g.style.height=e-32+"px";g.style.border="none";g.style.position="relative";g.setAttribute("border",0);g.setAttribute("frameborder",0);g.setAttribute("frameBorder",0);g.setAttribute("marginwidth",0);g.setAttribute("marginheight",0);g.src=a;document.body.appendChild(u);t.appendChild(s);t.appendChild(g);document.body.appendChild(t);return g};var n=function(b){var d=document.createElement("div");d.id=q;d.style.position="fixed";d.style.top=0;d.style.bottom=0;d.style.right=0;d.style.left=0;d.style.backgroundColor="#000000";d.style.opacity="0.5";d.style.filter="alpha(opacity=50)";d.style.zIndex=10000;d.onclick=k(b);return d};var m=function(){var a=document.createElement("div");a.id=p;a.style.position="fixed";a.style.padding="10px";a.style.background='#ffffff url("https://www.filepicker.io/static/img/spinner.gif") no-repeat 50% 50%';a.style.top="10px";a.style.bottom="auto";a.style.right="auto";var s=r.window.getSize();var i=Math.min(s[1]-40,500);var h=Math.max(Math.min(s[0]-40,800),620);var c=(s[0]-h-40)/2;a.style.left=c+"px";a.style.height=i+"px";a.style.width=h+"px";a.style.overflow="hidden";a.style.webkitOverflowScrolling="touch";a.style.border="1px solid #999";a.style.webkitBorderRadius="3px";a.style.borderRadius="3px";a.style.margin="0";a.style.webkitBoxShadow="0 3px 7px rgba(0, 0, 0, 0.3)";a.style.boxShadow="0 3px 7px rgba(0, 0, 0, 0.3)";a.style.zIndex=10001;a.style.boxSizing="content-box";a.style.webkitBoxSizing="content-box";a.style.mozBoxSizing="content-box";return a};var l=function(d){var c=document.createElement("a");c.appendChild(document.createTextNode("\u00D7"));c.onclick=k(d);c.style.cssFloat="right";c.style.styleFloat="right";c.style.cursor="default";c.style.padding="0 5px 0 0px";c.style.fontSize="1.5em";c.style.color="#555555";c.style.textDecoration="none";return c};var k=function(b,a){a=!!a;return function(){if(r.uploading&&!a){if(!window.confirm("You are currently uploading. If you choose 'OK', the window will close and your upload will not finish. Do you want to stop uploading and close the window?")){return}}r.uploading=false;var e=document.getElementById(q);if(e){document.body.removeChild(e)}var d=document.getElementById(p);if(d){document.body.removeChild(d)}try{delete window.frames[r.window.WINDOW_NAME]}catch(c){}if(b){b()}}};var j=k(function(){});return{generate:o,close:j}});filepicker.extend("picker",function(){var h=this;var g=function(a){var n=function(p,o,b){if(a[o]){if(!h.util.isArray(a[o])){a[o]=[a[o]]}}else{if(a[p]){a[o]=[a[p]]}else{if(b){a[o]=b}}}};n("service","services");n("mimetype","mimetypes");n("extension","extensions");if(a.services){for(var m=0;m<a.services.length;m++){var f=(""+a.services[m]).replace(" ","");if(h.services[f]!==undefined){f=h.services[f]}a.services[m]=f}}if(a.mimetypes&&a.extensions){throw h.FilepickerException("Error: Cannot pass in both mimetype and extension parameters to the pick function")}if(!a.mimetypes&&!a.extensions){a.mimetypes=["*/*"]}if(a.openTo){a.openTo=h.services[a.openTo]||a.openTo}h.util.setDefault(a,"container","modal")};var l=function(a,f){var e=function(c){if(c.type!=="filepickerUrl"){return}h.uploading=false;if(c.error){h.util.console.error(c.error);f(h.errors.FPError(102))}else{var b={};b.url=c.payload.url;b.filename=c.payload.data.filename;b.mimetype=c.payload.data.type;b.size=c.payload.data.size;if(c.payload.data.key){b.key=c.payload.data.key}b.isWriteable=true;a(b)}h.modal.close()};return e};var k=function(a){a=a||function(){};var d=function(b){if(b.type!=="uploading"){return}h.uploading=!!b.payload;a(h.uploading)};return d};var j=function(a,f){var e=function(o){if(o.type!=="filepickerUrl"){return}h.uploading=false;if(o.error){h.util.console.error(o.error);f(h.errors.FPError(102))}else{var n=[];if(!h.util.isArray(o.payload)){o.payload=[o.payload]}for(var m=0;m<o.payload.length;m++){var c={};var b=o.payload[m];c.url=b.url;c.filename=b.data.filename;c.mimetype=b.data.type;c.size=b.data.size;if(b.data.key){c.key=b.data.key}c.isWriteable=true;n.push(c)}a(n)}h.modal.close()};return e};var i=function(v,u,t,s){g(v);if(v.debug){setTimeout(function(){u({url:"https://www.filepicker.io/api/file/-nBq2onTSemLBxlcBWn1",filename:"test.png",mimetype:"image/png",size:58979})},1);return}if(h.cookies.THIRD_PARTY_COOKIES===undefined){h.cookies.checkThirdParty(function(){i(v,u,t,!!s)});return}var r=h.util.getId();var f=false;var e=function(m){f=true;u(m)};var d=function(m){f=true;t(m)};var c=function(){if(!f){f=true;t(h.errors.FPError(101))}};if(v.container=="modal"&&(v.mobile||h.window.shouldForce())){v.container="window"}h.window.open(v.container,h.urls.constructPickUrl(v,r,s),c);var b=s?j(e,d):l(e,d);h.handlers.attach(r,b);var a=r+"-upload";h.handlers.attach(a,k(function(){h.handlers.detach(a)}))};return{createPicker:i}});filepicker.extend("services",function(){return{COMPUTER:1,DROPBOX:2,FACEBOOK:3,GITHUB:4,GMAIL:5,IMAGE_SEARCH:6,URL:7,WEBCAM:8,GOOGLE_DRIVE:9,SEND_EMAIL:10,INSTAGRAM:11,FLICKR:12,VIDEO:13,EVERNOTE:14,PICASA:15,WEBDAV:16,FTP:17,ALFRESCO:18,BOX:19,SKYDRIVE:20}},true);filepicker.extend("util",function(){var h=this;var g=function(b){return b.replace(/^\s+|\s+$/g,"")};var l=/^(http|https)\:.*\/\//i;var k=function(b){return !!b.match(l)};var j=function(f){if(!f||f.charAt(0)=="/"){f=window.location.protocol+"//"+window.location.host+f}var e=document.createElement("a");e.href=f;var n=e.hostname.indexOf(":")==-1?e.hostname:e.host;var m={source:f,protocol:e.protocol.replace(":",""),host:n,port:e.port,query:e.search,params:(function(){var b={},r=e.search.replace(/^\?/,"").split("&"),q=r.length,p=0,o;for(;p<q;p++){if(!r[p]){continue}o=r[p].split("=");b[o[0]]=o[1]}return b})(),file:(e.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:e.hash.replace("#",""),path:e.pathname.replace(/^([^\/])/,"/$1"),relative:(e.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:e.pathname.replace(/^\//,"").split("/")};m.origin=m.protocol+"://"+m.host+(m.port?":"+m.port:"");return m};var i=function(d,c){return d.indexOf(c,d.length-c.length)!==-1};return{trim:g,parseUrl:j,isUrl:k,endsWith:i}});filepicker.extend("urls",function(){var t=this;var s="https://www.filepicker.io";if(window.filepicker.hostname){s=window.filepicker.hostname}var r=s+"/dialog/open/";var q=s+"/dialog/save/";var p=s+"/api/store/";var o=function(a,f,c){return r+"?key="+t.apikey+"&id="+f+"&referrer="+window.location.hostname+"&iframe="+(a.container!="window")+"&version="+t.API_VERSION+(a.services?"&s="+a.services.join(","):"")+(c?"&multi="+!!c:"")+(a.mimetypes!==undefined?"&m="+a.mimetypes.join(","):"")+(a.extensions!==undefined?"&ext="+a.extensions.join(","):"")+(a.openTo!==undefined?"&loc="+a.openTo:"")+(a.maxSize?"&maxSize="+a.maxSize:"")+(a.signature?"&signature="+a.signature:"")+(a.policy?"&policy="+a.policy:"")+(a.mobile!==undefined?"&mobile="+a.mobile:"")+(a.storeLocation?"&storeLocation="+a.storeLocation:"")+(a.storePath?"&storePath="+a.storePath:"")+(a.storeAccess?"&storeAccess="+a.storeAccess:"")};var n=function(a,f,d){if(a.indexOf("&")>=0||a.indexOf("?")>=0){a=encodeURIComponent(a)}return q+"?url="+a+"&key="+t.apikey+"&id="+d+"&referrer="+window.location.hostname+"&iframe="+(f.container!="window")+"&version="+t.API_VERSION+(f.services?"&s="+f.services.join(","):"")+(f.openTo!==undefined?"&loc="+f.openTo:"")+(f.mimetype!==undefined?"&m="+f.mimetype:"")+(f.extension!==undefined?"&ext="+f.extension:"")+(f.mobile!==undefined?"&mobile="+f.mobile:"")+(f.suggestedFilename!==undefined?"&defaultSaveasName="+f.suggestedFilename:"")+(f.signature?"&signature="+f.signature:"")+(f.policy?"&policy="+f.policy:"")};var m=function(a){return p+a.storage+"?key="+t.apikey+(a.base64decode?"&base64decode=true":"")+(a.mimetype?"&mimetype="+a.mimetype:"")+(a.filename?"&filename="+a.filename:"")+(a.path?"&path="+a.path:"")+(a.access?"&access="+a.access:"")+(a.signature?"&signature="+a.signature:"")+(a.policy?"&policy="+a.policy:"")};var l=function(d,c){return d+"?nonce=fp"+(!!c.base64decode?"&base64decode=true":"")+(c.mimetype?"&mimetype="+c.mimetype:"")+(c.signature?"&signature="+c.signature:"")+(c.policy?"&policy="+c.policy:"")};var k=function(){var a=t.util.parseUrl(window.location.href);return a.origin+"/404"};return{BASE:s,COMM:s+"/dialog/comm_iframe/",FP_COMM_FALLBACK:s+"/dialog/comm_hash_iframe/",STORE:p,PICK:r,EXPORT:q,constructPickUrl:o,constructExportUrl:n,constructWriteUrl:l,constructStoreUrl:m,constructHostCommFallback:k}});filepicker.extend("util",function(){var B=this;var A=function(b){return b&&Object.prototype.toString.call(b)==="[object Array]"};var z=function(b){return b&&Object.prototype.toString.call(b)==="[object File]"};var y=function(b){if(typeof HTMLElement==="object"){return b instanceof HTMLElement}else{return b&&typeof b==="object"&&b.nodeType===1&&typeof b.nodeName==="string"}};var x=function(b){return y(b)&&b.tagName=="INPUT"&&b.type=="file"};var w=function(b){if(b===null){return"null"}else{if(A(b)){return"array"}else{if(z(b)){return"file"}}}return typeof b};var v=function(){var b=new Date();return b.getTime().toString()};var u=function(e,d,f){if(e[d]===undefined){e[d]=f}};var t=function(e){if(window.jQuery){window.jQuery(function(){e()})}else{var d="load";if(window.addEventListener){window.addEventListener(d,e,false)}else{if(window.attachEvent){window.attachEvent("on"+d,e)}else{if(window.onload){var f=window.onload;window.onload=function(){f();e()}}else{window.onload=e}}}}};var s=function(b){return typeof b=="string"&&b.match("www.filepicker.io/api/file/")};var r=function(b){return function(){if(window.console&&typeof window.console[b]=="function"){try{window.console[b].apply(window.console,arguments)}catch(a){alert(Array.prototype.join.call(arguments,","))}}}};var q={};q.log=r("log");q.error=r("error");var p=function(d){var c={};for(key in d){c[key]=d[key]}return c};var o=function(d){var c={};c.url=d.url;c.filename=d.filename||d.name;c.mimetype=d.mimetype||d.type;c.size=d.size;c.key=d.key||d.s3_key;c.isWriteable=!!(d.isWriteable||d.writeable);return c};return{isArray:A,isFile:z,isElement:y,isFileInputElement:x,getId:v,setDefault:u,typeOf:w,addOnLoad:t,isFPUrl:s,console:q,clone:p,standardizeFPFile:o}});filepicker.extend("widgets",function(){var x=this;var w=function(g,f,j,i){var h=i.getAttribute(j);if(h){f[g]=h}};var v=function(e,d){var f;if(document.createEvent){f=document.createEvent("Event");f.initEvent("change",true,false);f.fpfile=d?d[0]:undefined;f.fpfiles=d;e.dispatchEvent(f)}else{if(document.createEventObject){f=document.createEventObject("Event");f.eventPhase=2;f.currentTarget=f.srcElement=f.target=e;f.fpfile=d?d[0]:undefined;f.fpfiles=d;e.fireEvent("onchange",f)}else{if(e.onchange){e.onchange(d)}}}};var u=function(B){var A=document.createElement("button");A.setAttribute("type","button");A.innerHTML=B.getAttribute("data-fp-button-text")||B.getAttribute("data-fp-text")||"Pick File";A.className=B.getAttribute("data-fp-button-class")||B.getAttribute("data-fp-class")||B.className;B.style.display="none";var z={};w("container",z,"data-fp-option-container",B);w("maxSize",z,"data-fp-option-maxsize",B);w("mimetype",z,"data-fp-mimetype",B);w("mimetypes",z,"data-fp-mimetypes",B);w("extension",z,"data-fp-extension",B);w("extensions",z,"data-fp-extensions",B);w("container",z,"data-fp-container",B);w("maxSize",z,"data-fp-maxSize",B);w("openTo",z,"data-fp-openTo",B);w("debug",z,"data-fp-debug",B);w("signature",z,"data-fp-signature",B);w("policy",z,"data-fp-policy",B);w("storeLocation",z,"data-fp-store-location",B);w("storePath",z,"data-fp-store-path",B);w("storeAccess",z,"data-fp-store-access",B);var y=B.getAttribute("data-fp-services");if(!y){y=B.getAttribute("data-fp-option-services")}if(y){y=y.split(",");for(var l=0;l<y.length;l++){y[l]=x.services[y[l].replace(" ","")]}z.services=y}var c=B.getAttribute("data-fp-service");if(c){z.service=x.services[c.replace(" ","")]}if(z.mimetypes){z.mimetypes=z.mimetypes.split(",")}if(z.extensions){z.extensions=z.extensions.split(",")}var b=B.getAttribute("data-fp-apikey");if(b){x.setKey(b)}var a=(B.getAttribute("data-fp-multiple")||B.getAttribute("data-fp-option-multiple")||"false")=="true";if(a){A.onclick=function(){A.blur();x.pickMultiple(z,function(f){var d=[];for(var g=0;g<f.length;g++){d.push(f[g].url)}B.value=d.join();v(B,f)});return false}}else{A.onclick=function(){A.blur();x.pick(z,function(d){B.value=d.url;v(B,[d])});return false}}B.parentNode.insertBefore(A,B)};var t=function(B){var A=document.createElement("div");A.className=B.getAttribute("data-fp-class")||B.className;A.style.padding="1px";B.style.display="none";B.parentNode.insertBefore(A,B);var z=document.createElement("button");z.setAttribute("type","button");z.innerHTML=B.getAttribute("data-fp-button-text")||"Pick File";z.className=B.getAttribute("data-fp-button-class")||"";A.appendChild(z);var y=document.createElement("div");r(y);y.innerHTML=B.getAttribute("data-fp-drag-text")||"Or drop files here";y.className=B.getAttribute("data-fp-drag-class")||"";A.appendChild(y);var h={};w("container",h,"data-fp-option-container",B);w("maxSize",h,"data-fp-option-maxsize",B);w("mimetype",h,"data-fp-mimetype",B);w("mimetypes",h,"data-fp-mimetypes",B);w("extension",h,"data-fp-extension",B);w("extensions",h,"data-fp-extensions",B);w("container",h,"data-fp-container",B);w("maxSize",h,"data-fp-maxSize",B);w("openTo",h,"data-fp-openTo",B);w("debug",h,"data-fp-debug",B);w("signature",h,"data-fp-signature",B);w("policy",h,"data-fp-policy",B);w("storeLocation",h,"data-fp-store-location",B);w("storePath",h,"data-fp-store-path",B);w("storeAccess",h,"data-fp-store-access",B);var g=B.getAttribute("data-fp-services");if(!g){g=B.getAttribute("data-fp-option-services")}if(g){g=g.split(",");for(var f=0;f<g.length;f++){g[f]=x.services[g[f].replace(" ","")]}h.services=g}var c=B.getAttribute("data-fp-service");if(c){h.service=x.services[c.replace(" ","")]}if(h.mimetypes){h.mimetypes=h.mimetypes.split(",")}if(h.extensions){h.extensions=h.extensions.split(",")}var b=B.getAttribute("data-fp-apikey");if(b){x.setKey(b)}var a=(B.getAttribute("data-fp-multiple")||B.getAttribute("data-fp-option-multiple")||"false")=="true";if(x.dragdrop.enabled()){q(y,a,h,B)}else{y.innerHTML="&nbsp;"}if(a){y.onclick=z.onclick=function(){z.blur();x.pickMultiple(h,function(i){var d=[];var k=[];for(var j=0;j<i.length;j++){d.push(i[j].url);k.push(i[j].filename)}B.value=d.join();s(B,y,k.join(", "));v(B,i)});return false}}else{y.onclick=z.onclick=function(){z.blur();x.pick(h,function(d){B.value=d.url;s(B,y,d.filename);v(B,[d])});return false}}};var s=function(a,j,i){j.innerHTML=i;j.style.padding="2px 4px";j.style.cursor="default";j.style.width="";var g=document.createElement("span");g.innerHTML="X";g.style.borderRadius="8px";g.style.fontSize="14px";g.style.cssFloat="right";g.style.padding="0 3px";g.style.color="#600";g.style.cursor="pointer";var c=function(b){if(!b){b=window.event}b.cancelBubble=true;if(b.stopPropagation){b.stopPropagation()}r(j);if(!x.dragdrop.enabled){j.innerHTML="&nbsp;"}else{j.innerHTML=a.getAttribute("data-fp-drag-text")||"Or drop files here"}a.value="";v(a);return false};if(g.addEventListener){g.addEventListener("click",c,false)}else{if(g.attachEvent){g.attachEvent("onclick",c)}}j.appendChild(g)};var r=function(b){b.style.border="1px dashed #AAA";b.style.display="inline-block";b.style.margin="0 0 0 4px";b.style.borderRadius="3px";b.style.backgroundColor="#F3F3F3";b.style.color="#333";b.style.fontSize="14px";b.style.lineHeight="22px";b.style.padding="2px 4px";b.style.verticalAlign="middle";b.style.cursor="pointer";b.style.overflow="hidden"};var q=function(a,l,k,i){var f=a.innerHTML;var c;x.dragdrop.makeDropPane(a,{multiple:l,maxSize:k.maxSize,mimetypes:k.mimetypes,mimetype:k.mimetype,extensions:k.extensions,extension:k.extension,location:k.storeLocation,path:k.storePath,access:k.storeAccess,policy:k.policy,signature:k.signature,dragEnter:function(){a.innerHTML="Drop to upload";a.style.backgroundColor="#E0E0E0";a.style.border="1px solid #000"},dragLeave:function(){a.innerHTML=f;a.style.backgroundColor="#F3F3F3";a.style.border="1px dashed #AAA"},onError:function(b,d){if(b=="TooManyFiles"){a.innerHTML=d}else{if(b=="WrongType"){a.innerHTML=d}else{if(b=="NoFilesFound"){a.innerHTML=d}else{if(b=="UploadError"){a.innerHTML="Oops! Had trouble uploading."}}}}},onStart:function(b){c=p(a)},onProgress:function(b){if(c){c.style.width=b+"%"}},onSuccess:function(b){var y=[];var j=[];for(var g=0;g<b.length;g++){y.push(b[g].url);j.push(b[g].filename)}i.value=y.join();s(i,a,j.join(", "));v(i,b)}})};var p=function(e){var d=document.createElement("div");var f=e.offsetHeight-2;d.style.height=f+"px";d.style.backgroundColor="#0E90D2";d.style.width="2%";d.style.borderRadius="3px";e.style.width=e.offsetWidth+"px";e.style.padding="0";e.style.border="1px solid #AAA";e.style.backgroundColor="#F3F3F3";e.style.boxShadow="inset 0 1px 2px rgba(0, 0, 0, 0.1)";e.innerHTML="";e.appendChild(d);return d};var o=function(a){a.onclick=function(){var k=a.getAttribute("data-fp-url");if(!k){return true}var j={};w("container",j,"data-fp-option-container",a);w("suggestedFilename",j,"data-fp-option-defaultSaveasName",a);w("container",j,"data-fp-container",a);w("suggestedFilename",j,"data-fp-suggestedFilename",a);w("mimetype",j,"data-fp-mimetype",a);w("extension",j,"data-fp-extension",a);var i=a.getAttribute("data-fp-services");if(!i){i=a.getAttribute("data-fp-option-services")}if(i){i=i.split(",");for(var c=0;c<i.length;c++){i[c]=x.services[i[c].replace(" ","")]}j.services=i}var b=a.getAttribute("data-fp-service");if(b){j.service=x.services[b.replace(" ","")]}apikey=a.getAttribute("data-fp-apikey");if(apikey){x.setKey(apikey)}x.exportFile(k,j);return false}};var n=function(){if(document.querySelectorAll){var e;var d=document.querySelectorAll('input[type="filepicker"]');for(e=0;e<d.length;e++){u(d[e])}var j=document.querySelectorAll('input[type="filepicker-dragdrop"]');for(e=0;e<j.length;e++){t(j[e])}var i=[];var h=document.querySelectorAll("button[data-fp-url]");for(e=0;e<h.length;e++){i.push(h[e])}h=document.querySelectorAll("a[data-fp-url]");for(e=0;e<h.length;e++){i.push(h[e])}h=document.querySelectorAll('input[type="button"][data-fp-url]');for(e=0;e<h.length;e++){i.push(h[e])}for(e=0;e<i.length;e++){o(i[e])}}};var m=function(d){if(d.jquery){d=d[0]}var c=d.getAttribute("type");if(c=="filepicker"){u(d)}else{if(c=="filepicker-dragdrop"){t(d)}else{o(d)}}};return{constructPickWidget:u,constructDragWidget:t,constructExportWidget:o,buildWidgets:n,constructWidget:m}});filepicker.extend("window",function(){var j=this;var i={OPEN:"/dialog/open/",SAVEAS:"/dialog/save/"};var p="filepicker_dialog";var o="left=100,top=100,height=600,width=800,menubar=no,toolbar=no,location=no,personalbar=no,status=no,resizable=yes,scrollbars=yes,dependent=yes,dialog=yes";var n=1000;var m=function(){if(document.body&&document.body.offsetWidth){winW=document.body.offsetWidth;winH=document.body.offsetHeight}if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){winW=document.documentElement.offsetWidth;winH=document.documentElement.offsetHeight}if(window.innerWidth&&window.innerHeight){winW=window.innerWidth;winH=window.innerHeight}return[winW,winH]};var l=function(){var a=m()[0]<768;var d=j.cookies.THIRD_PARTY_COOKIES===false;return j.browser.isIOS()||j.browser.isAndroid()||a||d};var k=function(a,r,q){q=q||function(){};if(!a){a="modal"}if(a=="modal"&&l()){a="window"}if(a=="window"){var g=p+j.util.getId();var e=window.open(r,g,o);var d=window.setInterval(function(){if(!e||e.closed){window.clearInterval(d);q()}},n)}else{if(a=="modal"){j.modal.generate(r,q)}else{var c=document.getElementById(a);if(!c){throw new j.FilepickerException("Container '"+a+"' not found. This should either be set to 'window','modal', or the ID of an iframe that is currently in the document.")}c.src=r}}};return{open:k,WINDOW_NAME:p,getSize:m,shouldForce:l}});(function(){filepicker.internal(function(){var b=this;b.util.addOnLoad(b.cookies.checkThirdParty);b.util.addOnLoad(b.widgets.buildWidgets)});delete filepicker.internal;delete filepicker.extend;var f=filepicker._queue||[];var e;var h=f.length;if(h){for(var g=0;g<h;g++){e=f[g];filepicker[e[0]].apply(filepicker,e[1])}}delete filepicker._queue})();